"use strict";var Rn=Object.defineProperty;var bo=Object.getOwnPropertyDescriptor;var _o=Object.getOwnPropertyNames;var xo=Object.prototype.hasOwnProperty;var ko=(t,e)=>{for(var n in e)Rn(t,n,{get:e[n],enumerable:!0})},Co=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of _o(e))!xo.call(t,i)&&i!==n&&Rn(t,i,{get:()=>e[i],enumerable:!(r=bo(e,i))||r.enumerable});return t};var Eo=t=>Co(Rn({},"__esModule",{value:!0}),t);var ea={};ko(ea,{UPDATE_DEBOUNCE:()=>rt,default:()=>On});module.exports=Eo(ea);var se=require("obsidian");var Fn=require("obsidian"),J=new Map,Cr=0,ie;function Er(t){ie=t}function Se(){return J}var Wn=(t,e)=>{if(!(ie.settings.enableIgnoreObsExcludeFoldersLinksFrom&&(t!=null&&t.path)&&ie.app.metadataCache.isUserIgnored(t==null?void 0:t.path))){for(let n of[e==null?void 0:e.links,e==null?void 0:e.embeds,e==null?void 0:e.frontmatterLinks])if(n)for(let r of n){let{path:i,subpath:o}=(0,Fn.parseLinktext)(r.link),s=app.metadataCache.getFirstLinkpathDest(i,"/");if(s){if(ie.settings.enableIgnoreObsExcludeFoldersLinksTo&&(s!=null&&s.path)&&ie.app.metadataCache.isUserIgnored(s.path))return;let l=s?app.metadataCache.getFileCache(s):null;if(l!=null&&l.frontmatter&&(l==null?void 0:l.frontmatter["snw-index-exclude"])===!0)continue;let a=s?s.path.replace(`.${s.extension}`,"")+o:i;J.has(a)||J.set(a,[]),J.get(a).push({realLink:r.link,reference:r,resolvedFile:s,sourceFile:t})}else{J.has(r.link)||J.set(r.link,[]);let l={vault:ie.app.vault,path:`${i}.md`,name:`${i}.md`,parent:null,stat:{ctime:0,mtime:0,size:0},basename:i,extension:"md"};J.get(r.link).push({realLink:r.link,reference:r,resolvedFile:l,sourceFile:t})}}}},Pr=async t=>{var e;for(let[n,r]of J.entries()){for(let i=r.length-1;i>=0;i--){let o=r[i];o!=null&&o.sourceFile&&((e=o==null?void 0:o.sourceFile)==null?void 0:e.path)===t.path&&r.splice(i,1)}J.set(n,r)}};function tn(){if(ie.showCountsActive===!0){J=new Map;for(let t of ie.app.vault.getMarkdownFiles()){let e=ie.app.metadataCache.getFileCache(t);e&&Wn(t,e)}window.snwAPI.references=J,Cr=Date.now()}}var An=new Map;function pe(t){var i;if(An.has(t.path)){let o=An.get(t.path);if(o){let s=(i=o.createDate)!=null?i:0;if(Cr<s&&s+500>Date.now())return o}}if(ie.showCountsActive!==!0)return{};let e={},n=ie.app.metadataCache.getFileCache(t);if(!n)return e;J||tn();let r=Object.values(ie.app.metadataCache.metadataCache).reduce((o,s)=>{let l=s.headings;if(l)for(let a of l)o.push(a.heading);return o},[]);if(n!=null&&n.blocks){let o=t.path.replace(`.${t.extension}`,"");e.blocks=Object.values(n.blocks).map(s=>{let l=`${o}#^${s.id}`;return{key:l,pos:s.position,page:t.basename,type:"block",references:J.get(l)||[]}})}return n!=null&&n.headings&&(e.headings=n.headings.map(o=>{let s="#".repeat(o.level)+o.heading,l=`${t.path.replace(`.${t.extension}`,"")}#${o.heading.replace(/\[|\]/g,"")}`;return{original:s,key:l,headerMatch:o.heading.replaceAll("[","").replaceAll("]",""),pos:o.position,page:t.basename,type:"heading",references:J.get(l)||[]}})),n!=null&&n.links&&(e.links=n.links.map(o=>{let s=be(o.link);return s===""&&(s=o.link),(s.startsWith("#^")||s.startsWith("#"))&&(s=t.path.replace(`.${t.extension}`,"")+s),{key:s,original:o.original,type:"link",pos:o.position,page:t.basename,references:J.get(s)||[]}}),e.links&&(e.links=e.links.map(o=>{if(o.key.includes("#")&&!o.key.includes("#^")){let s=r.filter(l=>l===o.key.split("#")[1])[0];o.original=s||void 0}return o}))),n!=null&&n.embeds&&(e.embeds=n.embeds.map(o=>{let s=be(o.link);return s=s===""?o.link:s,s===""&&(o.link.startsWith("#^")||o.link.startsWith("#"))&&(s=t.path.replace(`.${t.extension}`,"")+o.link),{key:s,page:t.basename,type:"embed",pos:o.position,references:J.get(s)||[]}}),e.embeds&&(e.embeds=e.embeds.map(o=>{if(o.key.includes("#")&&!o.key.includes("#^")&&e.headings){let s=r.filter(l=>l.includes(o.key.split("#")[1]))[0];o.original=s||void 0}return(o.key.startsWith("#^")||o.key.startsWith("#"))&&(o.key=`${t.basename}${o.key}`,o.references=J.get(o.key)||[]),o}))),n!=null&&n.frontmatterLinks&&(e.frontmatterLinks=n.frontmatterLinks.map(o=>{let s=be(o.link);return s===""&&(s=o.link),{key:s,original:o.original,type:"frontmatterLink",pos:{start:{line:-1,col:-1,offset:-1},end:{line:-1,col:-1,offset:-1}},displayText:o.displayText,page:t.basename,references:J.get(s)||[]}})),e.cacheMetaData=n,e.createDate=Date.now(),An.set(t.path,e),e}function be(t){let e=(0,Fn.parseLinktext)(t),n=ie.app.metadataCache.getFirstLinkpathDest(e.path,"/");return n===null?"":n.path.replace(`.${n.extension}`,"")+e.subpath}var nn={enableOnStartupDesktop:!0,enableOnStartupMobile:!0,minimumRefCountThreshold:2,maxFileCountToDisplay:100,displayIncomingFilesheader:!0,displayInlineReferencesLivePreview:!0,displayInlineReferencesMarkdown:!0,displayInlineReferencesInSourceMode:!1,displayEmbedReferencesInGutter:!1,displayEmbedReferencesInGutterMobile:!1,displayPropertyReferences:!0,displayPropertyReferencesMobile:!1,enableRenderingBlockIdInMarkdown:!0,enableRenderingLinksInMarkdown:!0,enableRenderingHeadersInMarkdown:!0,enableRenderingEmbedsInMarkdown:!0,enableRenderingBlockIdInLivePreview:!0,enableRenderingLinksInLivePreview:!0,enableRenderingHeadersInLivePreview:!0,enableRenderingEmbedsInLivePreview:!0,enableIgnoreObsExcludeFoldersLinksFrom:!1,enableIgnoreObsExcludeFoldersLinksTo:!1,requireModifierKeyToActivateSNWView:!1,sortOptionDefault:"name-asc",displayCustomPropertyList:""};var St=class{constructor(e){this.console=(e,...n)=>{console.log(`SNW: ${e}`,n)};this.getMetaInfoByCurrentFile=async()=>{var e;return this.getMetaInfoByFileName(((e=this.plugin.app.workspace.getActiveFile())==null?void 0:e.path)||"")};this.searchReferencesStartingWith=async e=>{for(let[n,r]of Se())n.startsWith(e)&&console.log(n,r)};this.searchReferencesContains=async e=>{for(let[n,r]of Se())n.contains(e)&&console.log(n,r)};this.getMetaInfoByFileName=async e=>{let n=this.plugin.app.metadataCache.getFirstLinkpathDest(e,"/");return{TFile:n,metadataCache:n?this.plugin.app.metadataCache.getFileCache(n):null,SnwTransformedCache:n?pe(n):null}};this.plugin=e}};var Sr=require("obsidian"),Tt=class{constructor(e){this.snwCommands=[{id:"SNW-ToggleActiveState",icon:"dot-network",name:"Toggle active state of SNW plugin on/off",showInRibbon:!0,callback:async()=>{this.plugin.showCountsActive=!this.plugin.showCountsActive;let e=`SNW toggled ${this.plugin.showCountsActive?`ON

`:`OFF

`}`;e+="Tabs may require reloading for this change to take effect.",new Sr.Notice(e),this.plugin.toggleStateHeaderCount(),this.plugin.toggleStateSNWMarkdownPreview(),this.plugin.toggleStateSNWLivePreview(),this.plugin.toggleStateSNWGutters()}}];this.plugin=e;for(let n of this.snwCommands)this.plugin.addCommand({id:n.id,name:n.name,icon:n.icon,callback:async()=>{await n.callback()}})}};var R=require("obsidian"),rn=class extends R.PluginSettingTab{constructor(e,n){super(e,n),this.plugin=n}display(){let{containerEl:e}=this;e.empty(),new R.Setting(e).setHeading().setName("Enable on startup"),new R.Setting(e).setName("On the desktop enable SNW at startup").addToggle(n=>{n.setValue(this.plugin.settings.enableOnStartupDesktop),n.onChange(async r=>{this.plugin.settings.enableOnStartupDesktop=r,await this.plugin.saveSettings()})}),new R.Setting(e).setName("On mobile devices enable SNW at startup").addToggle(n=>{n.setValue(this.plugin.settings.enableOnStartupMobile),n.onChange(async r=>{this.plugin.settings.enableOnStartupMobile=r,await this.plugin.saveSettings()})}),new R.Setting(e).setHeading().setName("SNW Activation"),new R.Setting(e).setName("Require modifier key to activate SNW").setDesc(`If enabled, SNW will only activate when the modifier key is pressed when hovering the mouse over an SNW counter.  
						Otherwise, SNW will activate on a mouse hover. May require reopening open files to take effect.`).addToggle(n=>{n.setValue(this.plugin.settings.requireModifierKeyToActivateSNWView),n.onChange(async r=>{this.plugin.settings.requireModifierKeyToActivateSNWView=r,await this.plugin.saveSettings()})}),new R.Setting(e).setHeading().setName("Thresholds"),new R.Setting(e).setName("Minimal required count to show counter").setDesc(`This setting defines how many references there needs to be for the reference count box to appear. May require reloading open files.
				 Currently set to: ${this.plugin.settings.minimumRefCountThreshold} references.`).addSlider(n=>n.setLimits(1,1e3,1).setValue(this.plugin.settings.minimumRefCountThreshold).onChange(async r=>{this.plugin.settings.minimumRefCountThreshold=r,await this.plugin.saveSettings()}).setDynamicTooltip()),new R.Setting(e).setName("Maximum file references to show").setDesc(`This setting defines the max amount of files with their references are displayed in the popup or sidebar.  Set to 1000 for no maximum.
				 Currently set to: ${this.plugin.settings.maxFileCountToDisplay} references. Keep in mind higher numbers can affect performance on larger vaults.`).addSlider(n=>n.setLimits(1,1e3,1).setValue(this.plugin.settings.maxFileCountToDisplay).onChange(async r=>{this.plugin.settings.maxFileCountToDisplay=r,await this.plugin.saveSettings()}).setDynamicTooltip()),new R.Setting(e).setHeading().setName("Use Obsidian's Excluded Files list (Settings > Files & Links)"),new R.Setting(e).setName("Outgoing links").setDesc("If enabled, links FROM files in the excluded folder will not be included in SNW's reference counters. May require restarting Obsidian.").addToggle(n=>{n.setValue(this.plugin.settings.enableIgnoreObsExcludeFoldersLinksFrom),n.onChange(async r=>{this.plugin.settings.enableIgnoreObsExcludeFoldersLinksFrom=r,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Incoming links").setDesc("If enabled, links TO files in the excluded folder will not be included in SNW's reference counters.  May require restarting Obsidian.").addToggle(n=>{n.setValue(this.plugin.settings.enableIgnoreObsExcludeFoldersLinksTo),n.onChange(async r=>{this.plugin.settings.enableIgnoreObsExcludeFoldersLinksTo=r,await this.plugin.saveSettings()})}),new R.Setting(e).setHeading().setName("Properties"),new R.Setting(e).setName("Show references in properties on Desktop").addToggle(n=>{n.setValue(this.plugin.settings.displayPropertyReferences),n.onChange(async r=>{this.plugin.settings.displayPropertyReferences=r,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Show references in properties on mobile").addToggle(n=>{n.setValue(this.plugin.settings.displayPropertyReferencesMobile),n.onChange(async r=>{this.plugin.settings.displayPropertyReferencesMobile=r,await this.plugin.saveSettings()})}),new R.Setting(e).setHeading().setName("View Modes"),new R.Setting(e).setName("Incoming Links Header Count").setDesc("In header of a document, show number of incoming link to that file.").addToggle(n=>{n.setValue(this.plugin.settings.displayIncomingFilesheader),n.onChange(async r=>{this.plugin.settings.displayIncomingFilesheader=r,this.plugin.toggleStateHeaderCount(),await this.plugin.saveSettings()})}),new R.Setting(e).setName("Show SNW indicators in Live Preview Editor").setDesc("While using Live Preview, Display inline of the text of documents all reference counts for links, blocks and embeds.Note: files may need to be closed and reopened for this setting to take effect.").addToggle(n=>{n.setValue(this.plugin.settings.displayInlineReferencesLivePreview),n.onChange(async r=>{this.plugin.settings.displayInlineReferencesLivePreview=r,this.plugin.toggleStateSNWLivePreview(),await this.plugin.saveSettings()})}),new R.Setting(e).setName("Show SNW indicators in Reading view ").setDesc("While in Reading View of a document, display inline of the text of documents all reference counts for links, blocks and embeds.Note: files may need to be closed and reopened for this setting to take effect.").addToggle(n=>{n.setValue(this.plugin.settings.displayInlineReferencesMarkdown),n.onChange(async r=>{this.plugin.settings.displayInlineReferencesMarkdown=r,this.plugin.toggleStateSNWMarkdownPreview(),await this.plugin.saveSettings()})}),new R.Setting(e).setName("Show SNW indicators in Source Mode ").setDesc("While in Source Mode of a document, display inline of the text of documents all reference counts for links, blocks and embeds.By default, this is turned off since the goal of Source Mode is to see the raw markdown.Note: files may need to be closed and reopened for this setting to take effect.").addToggle(n=>{n.setValue(this.plugin.settings.displayInlineReferencesInSourceMode),n.onChange(async r=>{this.plugin.settings.displayInlineReferencesInSourceMode=r,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Embed references in Gutter in Live Preview Mode (Desktop)").setDesc(`Displays a count of references in the gutter while in live preview. This is done only in a
					  special scenario. It has to do with the way Obsidian renders embeds, example: ![[link]] when  
					  they are on its own line. Strange New Worlds cannot embed the count in this scenario, so a hint is 
					  displayed in the gutter. It is a hack, but at least we get some information.`).addToggle(n=>{n.setValue(this.plugin.settings.displayEmbedReferencesInGutter),n.onChange(async r=>{this.plugin.settings.displayEmbedReferencesInGutter=r,this.plugin.toggleStateSNWGutters(),await this.plugin.saveSettings()})}),new R.Setting(e).setName("Embed references in Gutter in Live Preview Mode (Mobile)").setDesc("This is off by default on mobile since the gutter takes up some space in the left margin.").addToggle(n=>{n.setValue(this.plugin.settings.displayEmbedReferencesInGutterMobile),n.onChange(async r=>{this.plugin.settings.displayEmbedReferencesInGutterMobile=r,this.plugin.toggleStateSNWGutters(),await this.plugin.saveSettings()})}),new R.Setting(e).setHeading().setName("Enable reference types in Reading Mode"),e.createEl("sup",{text:"(requires reopening documents to take effect)"}),new R.Setting(e).setName("Block ID").setDesc("Identifies block ID's, for example text blocks that end with a ^ and unique ID for that text block.").addToggle(n=>{n.setValue(this.plugin.settings.enableRenderingBlockIdInMarkdown),n.onChange(async r=>{this.plugin.settings.enableRenderingBlockIdInMarkdown=r,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Embeds").setDesc("Identifies embedded links, that is links that start with an explanation mark. For example: ![[PageName]].").addToggle(n=>{n.setValue(this.plugin.settings.enableRenderingEmbedsInMarkdown),n.onChange(async r=>{this.plugin.settings.enableRenderingEmbedsInMarkdown=r,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Links").setDesc("Identifies links in a document. For example: [[PageName]].").addToggle(n=>{n.setValue(this.plugin.settings.enableRenderingLinksInMarkdown),n.onChange(async r=>{this.plugin.settings.enableRenderingLinksInMarkdown=r,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Headers").setDesc("Identifies headers, that is lines of text that start with a hash mark or multiple hash marks. For example: # Heading 1.").addToggle(n=>{n.setValue(this.plugin.settings.enableRenderingHeadersInMarkdown),n.onChange(async r=>{this.plugin.settings.enableRenderingHeadersInMarkdown=r,await this.plugin.saveSettings()})}),new R.Setting(e).setHeading().setName("Enable reference types in Live Preview Mode"),e.createEl("sup",{text:"(requires reopening documents to take effect)"}),new R.Setting(e).setName("Block ID").setDesc("Identifies block ID's, for example text blocks that end with a ^ and unique ID for that text block.").addToggle(n=>{n.setValue(this.plugin.settings.enableRenderingBlockIdInLivePreview),n.onChange(async r=>{this.plugin.settings.enableRenderingBlockIdInLivePreview=r,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Embeds").setDesc("Identifies embedded links, that is links that start with an explanation mark. For example: ![[PageName]].").addToggle(n=>{n.setValue(this.plugin.settings.enableRenderingEmbedsInLivePreview),n.onChange(async r=>{this.plugin.settings.enableRenderingEmbedsInLivePreview=r,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Links").setDesc("Identifies links in a document. For example: [[PageName]].").addToggle(n=>{n.setValue(this.plugin.settings.enableRenderingLinksInLivePreview),n.onChange(async r=>{this.plugin.settings.enableRenderingLinksInLivePreview=r,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Headers").setDesc("Identifies headers, that is lines of text that start with a hash mark or multiple hash marks. For example: # Heading 1.").addToggle(n=>{n.setValue(this.plugin.settings.enableRenderingHeadersInLivePreview),n.onChange(async r=>{this.plugin.settings.enableRenderingHeadersInLivePreview=r,await this.plugin.saveSettings()})}),new R.Setting(e).setHeading().setName("Custom Display Settings"),new R.Setting(this.containerEl).setName("Custom Property List").setDesc("Displays properties from referenced files in the references list. The list is comma separated list of case-sensitive property names.").addText(n=>{n.setPlaceholder("Ex: Project, Summary").setValue(this.plugin.settings.displayCustomPropertyList).onChange(async r=>{this.plugin.settings.displayCustomPropertyList=r,await this.plugin.saveSettings()})})}};var no=require("obsidian");var pn,W,Or,Po,$e,Tr,Dr,Hn,Un,Vn,Bn,So,Lt={},Nr=[],To=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,jn=Array.isArray;function Re(t,e){for(var n in e)t[n]=e[n];return t}function Rr(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Lo(t,e,n){var r,i,o,s={};for(o in e)o=="key"?r=e[o]:o=="ref"?i=e[o]:s[o]=e[o];if(arguments.length>2&&(s.children=arguments.length>3?pn.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)s[o]===void 0&&(s[o]=t.defaultProps[o]);return sn(t,s,r,i,null)}function sn(t,e,n,r,i){var o={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:i==null?++Or:i,__i:-1,__u:0};return i==null&&W.vnode!=null&&W.vnode(o),o}function dt(t){return t.children}function an(t,e){this.props=t,this.context=e}function ft(t,e){if(e==null)return t.__?ft(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?ft(t):null}function Ar(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Ar(t)}}function Lr(t){(!t.__d&&(t.__d=!0)&&$e.push(t)&&!ln.__r++||Tr!==W.debounceRendering)&&((Tr=W.debounceRendering)||Dr)(ln)}function ln(){var t,e,n,r,i,o,s,l;for($e.sort(Hn);t=$e.shift();)t.__d&&(e=$e.length,r=void 0,o=(i=(n=t).__v).__e,s=[],l=[],n.__P&&((r=Re({},i)).__v=i.__v+1,W.vnode&&W.vnode(r),$n(n.__P,r,i,n.__n,n.__P.namespaceURI,32&i.__u?[o]:null,s,o==null?ft(i):o,!!(32&i.__u),l),r.__v=i.__v,r.__.__k[r.__i]=r,Hr(s,r,l),r.__e!=o&&Ar(r)),$e.length>e&&$e.sort(Hn));ln.__r=0}function Fr(t,e,n,r,i,o,s,l,a,c,f){var u,y,d,_,b,h=r&&r.__k||Nr,g=e.length;for(n.__d=a,Io(n,e,h),a=n.__d,u=0;u<g;u++)(d=n.__k[u])!=null&&(y=d.__i===-1?Lt:h[d.__i]||Lt,d.__i=u,$n(t,d,y,i,o,s,l,a,c,f),_=d.__e,d.ref&&y.ref!=d.ref&&(y.ref&&qn(y.ref,null,d),f.push(d.ref,d.__c||_,d)),b==null&&_!=null&&(b=_),65536&d.__u||y.__k===d.__k?a=Wr(d,a,t):typeof d.type=="function"&&d.__d!==void 0?a=d.__d:_&&(a=_.nextSibling),d.__d=void 0,d.__u&=-196609);n.__d=a,n.__e=b}function Io(t,e,n){var r,i,o,s,l,a=e.length,c=n.length,f=c,u=0;for(t.__k=[],r=0;r<a;r++)(i=e[r])!=null&&typeof i!="boolean"&&typeof i!="function"?(s=r+u,(i=t.__k[r]=typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?sn(null,i,null,null,null):jn(i)?sn(dt,{children:i},null,null,null):i.constructor===void 0&&i.__b>0?sn(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=t,i.__b=t.__b+1,o=null,(l=i.__i=Mo(i,n,s,f))!==-1&&(f--,(o=n[l])&&(o.__u|=131072)),o==null||o.__v===null?(l==-1&&u--,typeof i.type!="function"&&(i.__u|=65536)):l!==s&&(l==s-1?u--:l==s+1?u++:(l>s?u--:u++,i.__u|=65536))):i=t.__k[r]=null;if(f)for(r=0;r<c;r++)(o=n[r])!=null&&!(131072&o.__u)&&(o.__e==t.__d&&(t.__d=ft(o)),Vr(o,o))}function Wr(t,e,n){var r,i;if(typeof t.type=="function"){for(r=t.__k,i=0;r&&i<r.length;i++)r[i]&&(r[i].__=t,e=Wr(r[i],e,n));return e}t.__e!=e&&(e&&t.type&&!n.contains(e)&&(e=ft(t)),n.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType===8);return e}function Mo(t,e,n,r){var i=t.key,o=t.type,s=n-1,l=n+1,a=e[n];if(a===null||a&&i==a.key&&o===a.type&&!(131072&a.__u))return n;if(r>(a!=null&&!(131072&a.__u)?1:0))for(;s>=0||l<e.length;){if(s>=0){if((a=e[s])&&!(131072&a.__u)&&i==a.key&&o===a.type)return s;s--}if(l<e.length){if((a=e[l])&&!(131072&a.__u)&&i==a.key&&o===a.type)return l;l++}}return-1}function Ir(t,e,n){e[0]==="-"?t.setProperty(e,n==null?"":n):t[e]=n==null?"":typeof n!="number"||To.test(e)?n:n+"px"}function on(t,e,n,r,i){var o;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||Ir(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||Ir(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")o=e!==(e=e.replace(/(PointerCapture)$|Capture$/i,"$1")),e=e.toLowerCase()in t||e==="onFocusOut"||e==="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?r?n.u=r.u:(n.u=Un,t.addEventListener(e,o?Bn:Vn,o)):t.removeEventListener(e,o?Bn:Vn,o);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n==null?"":n;break e}catch(s){}typeof n=="function"||(n==null||n===!1&&e[4]!=="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function Mr(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=Un++;else if(e.t<n.u)return;return n(W.event?W.event(e):e)}}}function $n(t,e,n,r,i,o,s,l,a,c){var f,u,y,d,_,b,h,g,v,k,p,x,w,P,O,D,S=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(a=!!(32&n.__u),o=[l=e.__e=n.__e]),(f=W.__b)&&f(e);e:if(typeof S=="function")try{if(g=e.props,v="prototype"in S&&S.prototype.render,k=(f=S.contextType)&&r[f.__c],p=f?k?k.props.value:f.__:r,n.__c?h=(u=e.__c=n.__c).__=u.__E:(v?e.__c=u=new S(g,p):(e.__c=u=new an(g,p),u.constructor=S,u.render=Do),k&&k.sub(u),u.props=g,u.state||(u.state={}),u.context=p,u.__n=r,y=u.__d=!0,u.__h=[],u._sb=[]),v&&u.__s==null&&(u.__s=u.state),v&&S.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Re({},u.__s)),Re(u.__s,S.getDerivedStateFromProps(g,u.__s))),d=u.props,_=u.state,u.__v=e,y)v&&S.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),v&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(v&&S.getDerivedStateFromProps==null&&g!==d&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(g,p),!u.__e&&(u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(g,u.__s,p)===!1||e.__v===n.__v)){for(e.__v!==n.__v&&(u.props=g,u.state=u.__s,u.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(N){N&&(N.__=e)}),x=0;x<u._sb.length;x++)u.__h.push(u._sb[x]);u._sb=[],u.__h.length&&s.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(g,u.__s,p),v&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(d,_,b)})}if(u.context=p,u.props=g,u.__P=t,u.__e=!1,w=W.__r,P=0,v){for(u.state=u.__s,u.__d=!1,w&&w(e),f=u.render(u.props,u.state,u.context),O=0;O<u._sb.length;O++)u.__h.push(u._sb[O]);u._sb=[]}else do u.__d=!1,w&&w(e),f=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++P<25);u.state=u.__s,u.getChildContext!=null&&(r=Re(Re({},r),u.getChildContext())),v&&!y&&u.getSnapshotBeforeUpdate!=null&&(b=u.getSnapshotBeforeUpdate(d,_)),Fr(t,jn(D=f!=null&&f.type===dt&&f.key==null?f.props.children:f)?D:[D],e,n,r,i,o,s,l,a,c),u.base=e.__e,e.__u&=-161,u.__h.length&&s.push(u),h&&(u.__E=u.__=null)}catch(N){if(e.__v=null,a||o!=null){for(e.__u|=a?160:128;l&&l.nodeType===8&&l.nextSibling;)l=l.nextSibling;o[o.indexOf(l)]=null,e.__e=l}else e.__e=n.__e,e.__k=n.__k;W.__e(N,e,n)}else o==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=Oo(n.__e,e,n,r,i,o,s,a,c);(f=W.diffed)&&f(e)}function Hr(t,e,n){e.__d=void 0;for(var r=0;r<n.length;r++)qn(n[r],n[++r],n[++r]);W.__c&&W.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(o){o.call(i)})}catch(o){W.__e(o,i.__v)}})}function Oo(t,e,n,r,i,o,s,l,a){var c,f,u,y,d,_,b,h=n.props,g=e.props,v=e.type;if(v==="svg"?i="http://www.w3.org/2000/svg":v==="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),o!=null){for(c=0;c<o.length;c++)if((d=o[c])&&"setAttribute"in d==!!v&&(v?d.localName===v:d.nodeType===3)){t=d,o[c]=null;break}}if(t==null){if(v===null)return document.createTextNode(g);t=document.createElementNS(i,v,g.is&&g),l&&(W.__m&&W.__m(e,o),l=!1),o=null}if(v===null)h===g||l&&t.data===g||(t.data=g);else{if(o=o&&pn.call(t.childNodes),h=n.props||Lt,!l&&o!=null)for(h={},c=0;c<t.attributes.length;c++)h[(d=t.attributes[c]).name]=d.value;for(c in h)if(d=h[c],c!="children"){if(c=="dangerouslySetInnerHTML")u=d;else if(!(c in g)){if(c=="value"&&"defaultValue"in g||c=="checked"&&"defaultChecked"in g)continue;on(t,c,null,d,i)}}for(c in g)d=g[c],c=="children"?y=d:c=="dangerouslySetInnerHTML"?f=d:c=="value"?_=d:c=="checked"?b=d:l&&typeof d!="function"||h[c]===d||on(t,c,d,h[c],i);if(f)l||u&&(f.__html===u.__html||f.__html===t.innerHTML)||(t.innerHTML=f.__html),e.__k=[];else if(u&&(t.innerHTML=""),Fr(t,jn(y)?y:[y],e,n,r,v==="foreignObject"?"http://www.w3.org/1999/xhtml":i,o,s,o?o[0]:n.__k&&ft(n,0),l,a),o!=null)for(c=o.length;c--;)Rr(o[c]);l||(c="value",v==="progress"&&_==null?t.removeAttribute("value"):_!==void 0&&(_!==t[c]||v==="progress"&&!_||v==="option"&&_!==h[c])&&on(t,c,_,h[c],i),c="checked",b!==void 0&&b!==t[c]&&on(t,c,b,h[c],i))}return t}function qn(t,e,n){try{if(typeof t=="function"){var r=typeof t.__u=="function";r&&t.__u(),r&&e==null||(t.__u=t(e))}else t.current=e}catch(i){W.__e(i,n)}}function Vr(t,e,n){var r,i;if(W.unmount&&W.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||qn(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){W.__e(o,e)}r.base=r.__P=null}if(r=t.__k)for(i=0;i<r.length;i++)r[i]&&Vr(r[i],e,n||typeof t.type!="function");n||Rr(t.__e),t.__c=t.__=t.__e=t.__d=void 0}function Do(t,e,n){return this.constructor(t,n)}function _e(t,e,n){var r,i,o,s;W.__&&W.__(t,e),i=(r=typeof n=="function")?null:n&&n.__k||e.__k,o=[],s=[],$n(e,t=(!r&&n||e).__k=Lo(dt,null,[t]),i||Lt,Lt,e.namespaceURI,!r&&n?[n]:i?null:e.firstChild?pn.call(e.childNodes):null,o,!r&&n?n:i?i.__e:e.firstChild,r,s),Hr(o,t,s)}pn=Nr.slice,W={__e:function(t,e,n,r){for(var i,o,s;e=e.__;)if((i=e.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(t)),s=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,r||{}),s=i.__d),s)return i.__E=i}catch(l){t=l}throw t}},Or=0,Po=function(t){return t!=null&&t.constructor==null},an.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Re({},this.state),typeof t=="function"&&(t=t(Re({},n),this.props)),t&&Re(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Lr(this))},an.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Lr(this))},an.prototype.render=dt,$e=[],Dr=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Hn=function(t,e){return t.__v.__b-e.__v.__b},ln.__r=0,Un=0,Vn=Mr(!1),Bn=Mr(!0),So=0;var No=(t,e)=>{let n=getComputedStyle(t),r=n.position==="absolute",i=e?/(auto|scroll|hidden)/:/(auto|scroll)/;if(n.position==="fixed")return document.body;for(let o=t.parentElement;o;o=o.parentElement)if(n=getComputedStyle(o),(!r||n.position!=="static")&&i.test(n.overflow+n.overflowY+n.overflowX))return o;return document.body},cn=t=>{let e=t.querySelectorAll(".search-result-file-matched-text");for(let n of Array.from(e))if(n instanceof HTMLElement){let r=No(n,!0);r&&(r.scrollTop=n.offsetTop-r.offsetTop-r.offsetHeight/2)}};var nt=require("obsidian");var Zi=require("obsidian");var mt=require("obsidian");var It=(t,e)=>t.substring(e.start.offset,e.end.offset),Br=(t,e)=>t.substring(e.start.offset-e.start.col,e.end.offset),zn=(t,e)=>{try{return t.start.offset<=e.start.offset&&t.end.offset>=e.end.offset}catch(n){return!1}};var un=class{constructor(e,{listItems:n=[],headings:r=[],sections:i=[]}){this.fileContents=e;this.getListItemIndexContaining=e=>this.listItems.findIndex(({position:n})=>zn(n,e));this.getSectionContaining=e=>this.sections.find(({position:n})=>zn(n,e));this.getListItemWithDescendants=e=>{let n=this.listItems[e],r=[n];for(let i=e+1;i<this.listItems.length;i++){let o=this.listItems[i];if(o.parent<n.position.start.line)return r;r.push(o)}return r};this.listItems=n,this.headings=r,this.sections=i}getListBreadcrumbs(e){let n=[];if(this.listItems.length===0)return n;let r=this.getListItemIndexContaining(e);if(r<0)return n;let o=this.listItems[r],s=o.parent;if(this.isTopLevelListItem(o))return n;for(let l=r-1;l>=0;l--){let a=this.listItems[l];if(a.parent<s&&(n.unshift(a),s=a.parent),this.isTopLevelListItem(a))return n}return n}getFirstSectionUnder(e){return this.sections.find(n=>n.position.start.line>e.start.line)}getHeadingContaining(e){let n=this.getHeadingIndexContaining(e);return this.headings[n]}getHeadingBreadcrumbs(e){let n=[];if(this.headings.length===0)return n;let r=a=>{let c=this.headings[a].level,f=a-1;for(let u=f;u>=0;u--){let y=this.headings[u];y.level<c&&(c=y.level,n.unshift(y))}},i=this.getHeadingIndexContaining(e);if(i>=0)return r(i),n;let s=this.getIndexOfHeadingAbove(e);if(s>=0){let a=this.headings[s];return n.unshift(a),r(s),n}return n}isTopLevelListItem(e){return e.parent<=0}getIndexOfHeadingAbove(e){return e===void 0?-1:this.headings.reduce((n,r,i)=>r.position.start.line<e.start.line?i:n,-1)}getHeadingIndexContaining(e){return e===void 0?-1:this.headings.findIndex(n=>n.position.start.line===e.start.line)}};var Ur=t=>t.map(e=>e.trim()).filter(e=>e.length>0).join(" \u27A4 "),jr=(t,e)=>Ur(e.map(n=>It(t,n.position)).map(n=>n.trim().replace(/^-\s+/,""))),$r=(t,e)=>{let r=e[0].position.start.col;return e.map(i=>Br(t,i.position).slice(r)).join(`
`)},qr=t=>Ur(t.map(e=>e.heading));var Ro=0,ha=Array.isArray;function L(t,e,n,r,i,o){e||(e={});var s,l,a=e;"ref"in e&&(s=e.ref,delete e.ref);var c={type:t,props:a,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--Ro,__i:-1,__u:0,__source:i,__self:o};if(typeof t=="function"&&(s=t.defaultProps))for(l in s)a[l]===void 0&&(a[l]=s[l]);return W.vnode&&W.vnode(c),c}var oe;function zr(t){oe=t}var Gr=async t=>{var i,o,s,l;let e=t.reference.position!==void 0?t.reference.position.start.line.toString():"0",n=L("div",{className:"snw-ref-item-info search-result-file-match","snw-data-line-number":e,"snw-data-file-name":(o=t==null?void 0:t.sourceFile)==null?void 0:o.path.replace(`.${(i=t==null?void 0:t.sourceFile)==null?void 0:i.extension}`,""),"data-href":(l=t==null?void 0:t.sourceFile)==null?void 0:l.path.replace(`.${(s=t==null?void 0:t.sourceFile)==null?void 0:s.extension}`,""),dangerouslySetInnerHTML:{__html:(await Ao(t)).innerHTML}}),r=createDiv();return _e(n,r),r},Ao=async t=>{var y;let e=await oe.app.vault.cachedRead(t.sourceFile),n=oe.app.metadataCache.getFileCache(t.sourceFile),r=t.reference.position,i=createDiv();if(i.setAttribute("uic","uic"),(y=t.reference)!=null&&y.key)return i.innerText=`Used in property: ${t.reference.key}`,i;let o=new un(e,n),s=o.getHeadingBreadcrumbs(r);if(s.length>0){let d=i.createDiv();d.addClass("snw-breadcrumbs"),d.createEl("span",{text:"H"}),await mt.MarkdownRenderer.render(oe.app,qr(s),d,t.sourceFile.path,oe)}let l=o.getListItemIndexContaining(r);if(l>=0){let d=o.getListBreadcrumbs(r);if(d.length>0){let h=i.createDiv();h.addClass("snw-breadcrumbs"),h.createEl("span",{text:"L"}),await mt.MarkdownRenderer.render(oe.app,jr(e,d),h,t.sourceFile.path,oe)}let _=o.getListItemWithDescendants(l),b=i.createDiv();await mt.MarkdownRenderer.render(oe.app,$r(e,_),b,t.sourceFile.path,oe)}else{let d=o.getSectionContaining(r),_="";(d==null?void 0:d.position)!==void 0&&(_=It(e,d.position)),/^\[\^([\w]+)\]:(.*)$/.test(_)&&(_=_.replace("[","").replace("]:","")),await mt.MarkdownRenderer.render(oe.app,_,i,t.sourceFile.path,oe)}let c=o.getHeadingContaining(r);if(c){let d=o.getFirstSectionUnder(c.position);if(d){let _=i.createDiv();await mt.MarkdownRenderer.render(oe.app,It(e,d.position),_,t.sourceFile.path,oe)}}let f=i.querySelectorAll("*"),u=Array.from(f).find(d=>d.textContent===t.reference.displayText);try{u.addClass("search-result-file-matched-text")}catch(d){}return i};var U="top",Y="bottom",z="right",$="left",fn="auto",Ae=[U,Y,z,$],Te="start",qe="end",Kr="clippingParents",dn="viewport",gt="popper",Yr="reference",Gn=Ae.reduce(function(t,e){return t.concat([e+"-"+Te,e+"-"+qe])},[]),mn=[].concat(Ae,[fn]).reduce(function(t,e){return t.concat([e,e+"-"+Te,e+"-"+qe])},[]),Fo="beforeRead",Wo="read",Ho="afterRead",Vo="beforeMain",Bo="main",Uo="afterMain",jo="beforeWrite",$o="write",qo="afterWrite",Xr=[Fo,Wo,Ho,Vo,Bo,Uo,jo,$o,qo];function Z(t){return t?(t.nodeName||"").toLowerCase():null}function H(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function ce(t){var e=H(t).Element;return t instanceof e||t instanceof Element}function X(t){var e=H(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function ht(t){if(typeof ShadowRoot=="undefined")return!1;var e=H(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function zo(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},o=e.elements[n];!X(o)||!Z(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(s){var l=i[s];l===!1?o.removeAttribute(s):o.setAttribute(s,l===!0?"":l)}))})}function Go(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],o=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),l=s.reduce(function(a,c){return a[c]="",a},{});!X(i)||!Z(i)||(Object.assign(i.style,l),Object.keys(o).forEach(function(a){i.removeAttribute(a)}))})}}var Mt={name:"applyStyles",enabled:!0,phase:"write",fn:zo,effect:Go,requires:["computeStyles"]};function Q(t){return t.split("-")[0]}var me=Math.max,ze=Math.min,Le=Math.round;function vt(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Ot(){return!/^((?!chrome|android).)*safari/i.test(vt())}function ue(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,o=1;e&&X(t)&&(i=t.offsetWidth>0&&Le(r.width)/t.offsetWidth||1,o=t.offsetHeight>0&&Le(r.height)/t.offsetHeight||1);var s=ce(t)?H(t):window,l=s.visualViewport,a=!Ot()&&n,c=(r.left+(a&&l?l.offsetLeft:0))/i,f=(r.top+(a&&l?l.offsetTop:0))/o,u=r.width/i,y=r.height/o;return{width:u,height:y,top:f,right:c+u,bottom:f+y,left:c,x:c,y:f}}function Ge(t){var e=ue(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function Dt(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&ht(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function re(t){return H(t).getComputedStyle(t)}function Kn(t){return["table","td","th"].indexOf(Z(t))>=0}function ee(t){return((ce(t)?t.ownerDocument:t.document)||window.document).documentElement}function Ie(t){return Z(t)==="html"?t:t.assignedSlot||t.parentNode||(ht(t)?t.host:null)||ee(t)}function Jr(t){return!X(t)||re(t).position==="fixed"?null:t.offsetParent}function Ko(t){var e=/firefox/i.test(vt()),n=/Trident/i.test(vt());if(n&&X(t)){var r=re(t);if(r.position==="fixed")return null}var i=Ie(t);for(ht(i)&&(i=i.host);X(i)&&["html","body"].indexOf(Z(i))<0;){var o=re(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function ge(t){for(var e=H(t),n=Jr(t);n&&Kn(n)&&re(n).position==="static";)n=Jr(n);return n&&(Z(n)==="html"||Z(n)==="body"&&re(n).position==="static")?e:n||Ko(t)||e}function Ke(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Ye(t,e,n){return me(t,ze(e,n))}function Zr(t,e,n){var r=Ye(t,e,n);return r>n?n:r}function Nt(){return{top:0,right:0,bottom:0,left:0}}function Rt(t){return Object.assign({},Nt(),t)}function At(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var Yo=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,Rt(typeof e!="number"?e:At(e,Ae))};function Xo(t){var e,n=t.state,r=t.name,i=t.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,l=Q(n.placement),a=Ke(l),c=[$,z].indexOf(l)>=0,f=c?"height":"width";if(!(!o||!s)){var u=Yo(i.padding,n),y=Ge(o),d=a==="y"?U:$,_=a==="y"?Y:z,b=n.rects.reference[f]+n.rects.reference[a]-s[a]-n.rects.popper[f],h=s[a]-n.rects.reference[a],g=ge(o),v=g?a==="y"?g.clientHeight||0:g.clientWidth||0:0,k=b/2-h/2,p=u[d],x=v-y[f]-u[_],w=v/2-y[f]/2+k,P=Ye(p,w,x),O=a;n.modifiersData[r]=(e={},e[O]=P,e.centerOffset=P-w,e)}}function Jo(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Dt(e.elements.popper,i)&&(e.elements.arrow=i))}var Qr={name:"arrow",enabled:!0,phase:"main",fn:Xo,effect:Jo,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function fe(t){return t.split("-")[1]}var Zo={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Qo(t,e){var n=t.x,r=t.y,i=e.devicePixelRatio||1;return{x:Le(n*i)/i||0,y:Le(r*i)/i||0}}function ei(t){var e,n=t.popper,r=t.popperRect,i=t.placement,o=t.variation,s=t.offsets,l=t.position,a=t.gpuAcceleration,c=t.adaptive,f=t.roundOffsets,u=t.isFixed,y=s.x,d=y===void 0?0:y,_=s.y,b=_===void 0?0:_,h=typeof f=="function"?f({x:d,y:b}):{x:d,y:b};d=h.x,b=h.y;var g=s.hasOwnProperty("x"),v=s.hasOwnProperty("y"),k=$,p=U,x=window;if(c){var w=ge(n),P="clientHeight",O="clientWidth";if(w===H(n)&&(w=ee(n),re(w).position!=="static"&&l==="absolute"&&(P="scrollHeight",O="scrollWidth")),w=w,i===U||(i===$||i===z)&&o===qe){p=Y;var D=u&&w===x&&x.visualViewport?x.visualViewport.height:w[P];b-=D-r.height,b*=a?1:-1}if(i===$||(i===U||i===Y)&&o===qe){k=z;var S=u&&w===x&&x.visualViewport?x.visualViewport.width:w[O];d-=S-r.width,d*=a?1:-1}}var N=Object.assign({position:l},c&&Zo),I=f===!0?Qo({x:d,y:b},H(n)):{x:d,y:b};if(d=I.x,b=I.y,a){var T;return Object.assign({},N,(T={},T[p]=v?"0":"",T[k]=g?"0":"",T.transform=(x.devicePixelRatio||1)<=1?"translate("+d+"px, "+b+"px)":"translate3d("+d+"px, "+b+"px, 0)",T))}return Object.assign({},N,(e={},e[p]=v?b+"px":"",e[k]=g?d+"px":"",e.transform="",e))}function es(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,o=n.adaptive,s=o===void 0?!0:o,l=n.roundOffsets,a=l===void 0?!0:l,c={placement:Q(e.placement),variation:fe(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,ei(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:a})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,ei(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:a})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}var ti={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:es,data:{}};var gn={passive:!0};function ts(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,o=i===void 0?!0:i,s=r.resize,l=s===void 0?!0:s,a=H(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach(function(f){f.addEventListener("scroll",n.update,gn)}),l&&a.addEventListener("resize",n.update,gn),function(){o&&c.forEach(function(f){f.removeEventListener("scroll",n.update,gn)}),l&&a.removeEventListener("resize",n.update,gn)}}var ni={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:ts,data:{}};var ns={left:"right",right:"left",bottom:"top",top:"bottom"};function yt(t){return t.replace(/left|right|bottom|top/g,function(e){return ns[e]})}var rs={start:"end",end:"start"};function hn(t){return t.replace(/start|end/g,function(e){return rs[e]})}function Xe(t){var e=H(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function Je(t){return ue(ee(t)).left+Xe(t).scrollLeft}function Yn(t,e){var n=H(t),r=ee(t),i=n.visualViewport,o=r.clientWidth,s=r.clientHeight,l=0,a=0;if(i){o=i.width,s=i.height;var c=Ot();(c||!c&&e==="fixed")&&(l=i.offsetLeft,a=i.offsetTop)}return{width:o,height:s,x:l+Je(t),y:a}}function Xn(t){var e,n=ee(t),r=Xe(t),i=(e=t.ownerDocument)==null?void 0:e.body,o=me(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=me(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-r.scrollLeft+Je(t),a=-r.scrollTop;return re(i||n).direction==="rtl"&&(l+=me(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:l,y:a}}function Ze(t){var e=re(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function vn(t){return["html","body","#document"].indexOf(Z(t))>=0?t.ownerDocument.body:X(t)&&Ze(t)?t:vn(Ie(t))}function Fe(t,e){var n;e===void 0&&(e=[]);var r=vn(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),o=H(r),s=i?[o].concat(o.visualViewport||[],Ze(r)?r:[]):r,l=e.concat(s);return i?l:l.concat(Fe(Ie(s)))}function wt(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function is(t,e){var n=ue(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function ri(t,e,n){return e===dn?wt(Yn(t,n)):ce(e)?is(e,n):wt(Xn(ee(t)))}function os(t){var e=Fe(Ie(t)),n=["absolute","fixed"].indexOf(re(t).position)>=0,r=n&&X(t)?ge(t):t;return ce(r)?e.filter(function(i){return ce(i)&&Dt(i,r)&&Z(i)!=="body"}):[]}function Jn(t,e,n,r){var i=e==="clippingParents"?os(t):[].concat(e),o=[].concat(i,[n]),s=o[0],l=o.reduce(function(a,c){var f=ri(t,c,r);return a.top=me(f.top,a.top),a.right=ze(f.right,a.right),a.bottom=ze(f.bottom,a.bottom),a.left=me(f.left,a.left),a},ri(t,s,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function Ft(t){var e=t.reference,n=t.element,r=t.placement,i=r?Q(r):null,o=r?fe(r):null,s=e.x+e.width/2-n.width/2,l=e.y+e.height/2-n.height/2,a;switch(i){case U:a={x:s,y:e.y-n.height};break;case Y:a={x:s,y:e.y+e.height};break;case z:a={x:e.x+e.width,y:l};break;case $:a={x:e.x-n.width,y:l};break;default:a={x:e.x,y:e.y}}var c=i?Ke(i):null;if(c!=null){var f=c==="y"?"height":"width";switch(o){case Te:a[c]=a[c]-(e[f]/2-n[f]/2);break;case qe:a[c]=a[c]+(e[f]/2-n[f]/2);break;default:}}return a}function he(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,o=n.strategy,s=o===void 0?t.strategy:o,l=n.boundary,a=l===void 0?Kr:l,c=n.rootBoundary,f=c===void 0?dn:c,u=n.elementContext,y=u===void 0?gt:u,d=n.altBoundary,_=d===void 0?!1:d,b=n.padding,h=b===void 0?0:b,g=Rt(typeof h!="number"?h:At(h,Ae)),v=y===gt?Yr:gt,k=t.rects.popper,p=t.elements[_?v:y],x=Jn(ce(p)?p:p.contextElement||ee(t.elements.popper),a,f,s),w=ue(t.elements.reference),P=Ft({reference:w,element:k,strategy:"absolute",placement:i}),O=wt(Object.assign({},k,P)),D=y===gt?O:w,S={top:x.top-D.top+g.top,bottom:D.bottom-x.bottom+g.bottom,left:x.left-D.left+g.left,right:D.right-x.right+g.right},N=t.modifiersData.offset;if(y===gt&&N){var I=N[i];Object.keys(S).forEach(function(T){var K=[z,Y].indexOf(T)>=0?1:-1,te=[U,Y].indexOf(T)>=0?"y":"x";S[T]+=I[te]*K})}return S}function Zn(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,o=n.rootBoundary,s=n.padding,l=n.flipVariations,a=n.allowedAutoPlacements,c=a===void 0?mn:a,f=fe(r),u=f?l?Gn:Gn.filter(function(_){return fe(_)===f}):Ae,y=u.filter(function(_){return c.indexOf(_)>=0});y.length===0&&(y=u);var d=y.reduce(function(_,b){return _[b]=he(t,{placement:b,boundary:i,rootBoundary:o,padding:s})[Q(b)],_},{});return Object.keys(d).sort(function(_,b){return d[_]-d[b]})}function ss(t){if(Q(t)===fn)return[];var e=yt(t);return[hn(t),e,hn(e)]}function as(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,l=s===void 0?!0:s,a=n.fallbackPlacements,c=n.padding,f=n.boundary,u=n.rootBoundary,y=n.altBoundary,d=n.flipVariations,_=d===void 0?!0:d,b=n.allowedAutoPlacements,h=e.options.placement,g=Q(h),v=g===h,k=a||(v||!_?[yt(h)]:ss(h)),p=[h].concat(k).reduce(function(ke,de){return ke.concat(Q(de)===fn?Zn(e,{placement:de,boundary:f,rootBoundary:u,padding:c,flipVariations:_,allowedAutoPlacements:b}):de)},[]),x=e.rects.reference,w=e.rects.popper,P=new Map,O=!0,D=p[0],S=0;S<p.length;S++){var N=p[S],I=Q(N),T=fe(N)===Te,K=[U,Y].indexOf(I)>=0,te=K?"width":"height",j=he(e,{placement:N,boundary:f,rootBoundary:u,altBoundary:y,padding:c}),V=K?T?z:$:T?Y:U;x[te]>w[te]&&(V=yt(V));var M=yt(V),B=[];if(o&&B.push(j[I]<=0),l&&B.push(j[V]<=0,j[M]<=0),B.every(function(ke){return ke})){D=N,O=!1;break}P.set(N,B)}if(O)for(var ae=_?3:1,Ve=function(de){var Ce=p.find(function(at){var Ee=P.get(at);if(Ee)return Ee.slice(0,de).every(function(lt){return lt})});if(Ce)return D=Ce,"break"},we=ae;we>0;we--){var Be=Ve(we);if(Be==="break")break}e.placement!==D&&(e.modifiersData[r]._skip=!0,e.placement=D,e.reset=!0)}}var ii={name:"flip",enabled:!0,phase:"main",fn:as,requiresIfExists:["offset"],data:{_skip:!1}};function oi(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function si(t){return[U,z,Y,$].some(function(e){return t[e]>=0})}function ls(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,o=e.modifiersData.preventOverflow,s=he(e,{elementContext:"reference"}),l=he(e,{altBoundary:!0}),a=oi(s,r),c=oi(l,i,o),f=si(a),u=si(c);e.modifiersData[n]={referenceClippingOffsets:a,popperEscapeOffsets:c,isReferenceHidden:f,hasPopperEscaped:u},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":f,"data-popper-escaped":u})}var ai={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ls};function ps(t,e,n){var r=Q(t),i=[$,U].indexOf(r)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,s=o[0],l=o[1];return s=s||0,l=(l||0)*i,[$,z].indexOf(r)>=0?{x:l,y:s}:{x:s,y:l}}function cs(t){var e=t.state,n=t.options,r=t.name,i=n.offset,o=i===void 0?[0,0]:i,s=mn.reduce(function(f,u){return f[u]=ps(u,e.rects,o),f},{}),l=s[e.placement],a=l.x,c=l.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=a,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=s}var li={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:cs};function us(t){var e=t.state,n=t.name;e.modifiersData[n]=Ft({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}var pi={name:"popperOffsets",enabled:!0,phase:"read",fn:us,data:{}};function Qn(t){return t==="x"?"y":"x"}function fs(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,l=s===void 0?!1:s,a=n.boundary,c=n.rootBoundary,f=n.altBoundary,u=n.padding,y=n.tether,d=y===void 0?!0:y,_=n.tetherOffset,b=_===void 0?0:_,h=he(e,{boundary:a,rootBoundary:c,padding:u,altBoundary:f}),g=Q(e.placement),v=fe(e.placement),k=!v,p=Ke(g),x=Qn(p),w=e.modifiersData.popperOffsets,P=e.rects.reference,O=e.rects.popper,D=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,S=typeof D=="number"?{mainAxis:D,altAxis:D}:Object.assign({mainAxis:0,altAxis:0},D),N=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,I={x:0,y:0};if(w){if(o){var T,K=p==="y"?U:$,te=p==="y"?Y:z,j=p==="y"?"height":"width",V=w[p],M=V+h[K],B=V-h[te],ae=d?-O[j]/2:0,Ve=v===Te?P[j]:O[j],we=v===Te?-O[j]:-P[j],Be=e.elements.arrow,ke=d&&Be?Ge(Be):{width:0,height:0},de=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Nt(),Ce=de[K],at=de[te],Ee=Ye(0,P[j],ke[j]),lt=k?P[j]/2-ae-Ee-Ce-S.mainAxis:Ve-Ee-Ce-S.mainAxis,De=k?-P[j]/2+ae+Ee+at+S.mainAxis:we+Ee+at+S.mainAxis,pt=e.elements.arrow&&ge(e.elements.arrow),$t=pt?p==="y"?pt.clientTop||0:pt.clientLeft||0:0,xt=(T=N==null?void 0:N[p])!=null?T:0,qt=V+lt-xt-$t,zt=V+De-xt,kt=Ye(d?ze(M,qt):M,V,d?me(B,zt):B);w[p]=kt,I[p]=kt-V}if(l){var Ct,Gt=p==="x"?U:$,Kt=p==="x"?Y:z,Pe=w[x],Ne=x==="y"?"height":"width",Et=Pe+h[Gt],Ue=Pe-h[Kt],Pt=[U,$].indexOf(g)!==-1,Yt=(Ct=N==null?void 0:N[x])!=null?Ct:0,Xt=Pt?Et:Pe-P[Ne]-O[Ne]-Yt+S.altAxis,Jt=Pt?Pe+P[Ne]+O[Ne]-Yt-S.altAxis:Ue,Zt=d&&Pt?Zr(Xt,Pe,Jt):Ye(d?Xt:Et,Pe,d?Jt:Ue);w[x]=Zt,I[x]=Zt-Pe}e.modifiersData[r]=I}}var ci={name:"preventOverflow",enabled:!0,phase:"main",fn:fs,requiresIfExists:["offset"]};function er(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function tr(t){return t===H(t)||!X(t)?Xe(t):er(t)}function ds(t){var e=t.getBoundingClientRect(),n=Le(e.width)/t.offsetWidth||1,r=Le(e.height)/t.offsetHeight||1;return n!==1||r!==1}function nr(t,e,n){n===void 0&&(n=!1);var r=X(e),i=X(e)&&ds(e),o=ee(e),s=ue(t,i,n),l={scrollLeft:0,scrollTop:0},a={x:0,y:0};return(r||!r&&!n)&&((Z(e)!=="body"||Ze(o))&&(l=tr(e)),X(e)?(a=ue(e,!0),a.x+=e.clientLeft,a.y+=e.clientTop):o&&(a.x=Je(o))),{x:s.left+l.scrollLeft-a.x,y:s.top+l.scrollTop-a.y,width:s.width,height:s.height}}function ms(t){var e=new Map,n=new Set,r=[];t.forEach(function(o){e.set(o.name,o)});function i(o){n.add(o.name);var s=[].concat(o.requires||[],o.requiresIfExists||[]);s.forEach(function(l){if(!n.has(l)){var a=e.get(l);a&&i(a)}}),r.push(o)}return t.forEach(function(o){n.has(o.name)||i(o)}),r}function rr(t){var e=ms(t);return Xr.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function ir(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function or(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var ui={placement:"bottom",modifiers:[],strategy:"absolute"};function fi(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function di(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,o=i===void 0?ui:i;return function(l,a,c){c===void 0&&(c=o);var f={placement:"bottom",orderedModifiers:[],options:Object.assign({},ui,o),modifiersData:{},elements:{reference:l,popper:a},attributes:{},styles:{}},u=[],y=!1,d={state:f,setOptions:function(g){var v=typeof g=="function"?g(f.options):g;b(),f.options=Object.assign({},o,f.options,v),f.scrollParents={reference:ce(l)?Fe(l):l.contextElement?Fe(l.contextElement):[],popper:Fe(a)};var k=rr(or([].concat(r,f.options.modifiers)));return f.orderedModifiers=k.filter(function(p){return p.enabled}),_(),d.update()},forceUpdate:function(){if(!y){var g=f.elements,v=g.reference,k=g.popper;if(fi(v,k)){f.rects={reference:nr(v,ge(k),f.options.strategy==="fixed"),popper:Ge(k)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach(function(S){return f.modifiersData[S.name]=Object.assign({},S.data)});for(var p=0;p<f.orderedModifiers.length;p++){if(f.reset===!0){f.reset=!1,p=-1;continue}var x=f.orderedModifiers[p],w=x.fn,P=x.options,O=P===void 0?{}:P,D=x.name;typeof w=="function"&&(f=w({state:f,options:O,name:D,instance:d})||f)}}}},update:ir(function(){return new Promise(function(h){d.forceUpdate(),h(f)})}),destroy:function(){b(),y=!0}};if(!fi(l,a))return d;d.setOptions(c).then(function(h){!y&&c.onFirstUpdate&&c.onFirstUpdate(h)});function _(){f.orderedModifiers.forEach(function(h){var g=h.name,v=h.options,k=v===void 0?{}:v,p=h.effect;if(typeof p=="function"){var x=p({state:f,name:g,instance:d,options:k}),w=function(){};u.push(x||w)}})}function b(){u.forEach(function(h){return h()}),u=[]}return d}}var gs=[ni,pi,ti,Mt,li,ii,ci,Qr,ai],sr=di({defaultModifiers:gs});var hs="tippy-box",ki="tippy-content",vs="tippy-backdrop",Ci="tippy-arrow",Ei="tippy-svg-arrow",Qe={passive:!0,capture:!0},Pi=function(){return document.body};function ar(t,e,n){if(Array.isArray(t)){var r=t[e];return r==null?Array.isArray(n)?n[e]:n:r}return t}function fr(t,e){var n={}.toString.call(t);return n.indexOf("[object")===0&&n.indexOf(e+"]")>-1}function Si(t,e){return typeof t=="function"?t.apply(void 0,e):t}function mi(t,e){if(e===0)return t;var n;return function(r){clearTimeout(n),n=setTimeout(function(){t(r)},e)}}function ys(t){return t.split(/\s+/).filter(Boolean)}function bt(t){return[].concat(t)}function gi(t,e){t.indexOf(e)===-1&&t.push(e)}function ws(t){return t.filter(function(e,n){return t.indexOf(e)===n})}function bs(t){return t.split("-")[0]}function bn(t){return[].slice.call(t)}function hi(t){return Object.keys(t).reduce(function(e,n){return t[n]!==void 0&&(e[n]=t[n]),e},{})}function Wt(){return document.createElement("div")}function _n(t){return["Element","Fragment"].some(function(e){return fr(t,e)})}function _s(t){return fr(t,"NodeList")}function xs(t){return fr(t,"MouseEvent")}function Ti(t){return!!(t&&t._tippy&&t._tippy.reference===t)}function ks(t){return _n(t)?[t]:_s(t)?bn(t):Array.isArray(t)?t:bn(document.querySelectorAll(t))}function lr(t,e){t.forEach(function(n){n&&(n.style.transitionDuration=e+"ms")})}function vi(t,e){t.forEach(function(n){n&&n.setAttribute("data-state",e)})}function Cs(t){var e,n=bt(t),r=n[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function Es(t,e){var n=e.clientX,r=e.clientY;return t.every(function(i){var o=i.popperRect,s=i.popperState,l=i.props,a=l.interactiveBorder,c=bs(s.placement),f=s.modifiersData.offset;if(!f)return!0;var u=c==="bottom"?f.top.y:0,y=c==="top"?f.bottom.y:0,d=c==="right"?f.left.x:0,_=c==="left"?f.right.x:0,b=o.top-r+u>a,h=r-o.bottom-y>a,g=o.left-n+d>a,v=n-o.right-_>a;return b||h||g||v})}function pr(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){t[r](i,n)})}function yi(t,e){for(var n=e;n;){var r;if(t.contains(n))return!0;n=n.getRootNode==null||(r=n.getRootNode())==null?void 0:r.host}return!1}var xe={isTouch:!1},wi=0;function Ps(){xe.isTouch||(xe.isTouch=!0,window.performance&&document.addEventListener("mousemove",Li))}function Li(){var t=performance.now();t-wi<20&&(xe.isTouch=!1,document.removeEventListener("mousemove",Li)),wi=t}function Ss(){var t=document.activeElement;if(Ti(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}function Ts(){document.addEventListener("touchstart",Ps,Qe),window.addEventListener("blur",Ss)}var Ls=typeof window!="undefined"&&typeof document!="undefined",Is=Ls?!!window.msCrypto:!1;var Ms={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},Os={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},ve=Object.assign({appendTo:Pi,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},Ms,Os),Ds=Object.keys(ve),Ns=function(e){var n=Object.keys(e);n.forEach(function(r){ve[r]=e[r]})};function Ii(t){var e=t.plugins||[],n=e.reduce(function(r,i){var o=i.name,s=i.defaultValue;if(o){var l;r[o]=t[o]!==void 0?t[o]:(l=ve[o])!=null?l:s}return r},{});return Object.assign({},t,n)}function Rs(t,e){var n=e?Object.keys(Ii(Object.assign({},ve,{plugins:e}))):Ds,r=n.reduce(function(i,o){var s=(t.getAttribute("data-tippy-"+o)||"").trim();if(!s)return i;if(o==="content")i[o]=s;else try{i[o]=JSON.parse(s)}catch(l){i[o]=s}return i},{});return r}function bi(t,e){var n=Object.assign({},e,{content:Si(e.content,[t])},e.ignoreAttributes?{}:Rs(t,e.plugins));return n.aria=Object.assign({},ve.aria,n.aria),n.aria={expanded:n.aria.expanded==="auto"?e.interactive:n.aria.expanded,content:n.aria.content==="auto"?e.interactive?null:"describedby":n.aria.content},n}var As=function(){return"innerHTML"};function cr(t,e){t[As()]=e}function _i(t){var e=Wt();return t===!0?e.className=Ci:(e.className=Ei,_n(t)?e.appendChild(t):cr(e,t)),e}function xi(t,e){_n(e.content)?(cr(t,""),t.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?cr(t,e.content):t.textContent=e.content)}function ur(t){var e=t.firstElementChild,n=bn(e.children);return{box:e,content:n.find(function(r){return r.classList.contains(ki)}),arrow:n.find(function(r){return r.classList.contains(Ci)||r.classList.contains(Ei)}),backdrop:n.find(function(r){return r.classList.contains(vs)})}}function Mi(t){var e=Wt(),n=Wt();n.className=hs,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=Wt();r.className=ki,r.setAttribute("data-state","hidden"),xi(r,t.props),e.appendChild(n),n.appendChild(r),i(t.props,t.props);function i(o,s){var l=ur(e),a=l.box,c=l.content,f=l.arrow;s.theme?a.setAttribute("data-theme",s.theme):a.removeAttribute("data-theme"),typeof s.animation=="string"?a.setAttribute("data-animation",s.animation):a.removeAttribute("data-animation"),s.inertia?a.setAttribute("data-inertia",""):a.removeAttribute("data-inertia"),a.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?a.setAttribute("role",s.role):a.removeAttribute("role"),(o.content!==s.content||o.allowHTML!==s.allowHTML)&&xi(c,t.props),s.arrow?f?o.arrow!==s.arrow&&(a.removeChild(f),a.appendChild(_i(s.arrow))):a.appendChild(_i(s.arrow)):f&&a.removeChild(f)}return{popper:e,onUpdate:i}}Mi.$$tippy=!0;var Fs=1,yn=[],wn=[];function Ws(t,e){var n=bi(t,Object.assign({},ve,Ii(hi(e)))),r,i,o,s=!1,l=!1,a=!1,c=!1,f,u,y,d=[],_=mi(qt,n.interactiveDebounce),b,h=Fs++,g=null,v=ws(n.plugins),k={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},p={id:h,reference:t,popper:Wt(),popperInstance:g,props:n,state:k,plugins:v,clearDelayTimeouts:Xt,setProps:Jt,setContent:Zt,show:mo,hide:go,hideWithInteractivity:ho,enable:Pt,disable:Yt,unmount:vo,destroy:yo};if(!n.render)return p;var x=n.render(p),w=x.popper,P=x.onUpdate;w.setAttribute("data-tippy-root",""),w.id="tippy-"+p.id,p.popper=w,t._tippy=p,w._tippy=p;var O=v.map(function(m){return m.fn(p)}),D=t.hasAttribute("aria-expanded");return pt(),ae(),V(),M("onCreate",[p]),n.showOnCreate&&Et(),w.addEventListener("mouseenter",function(){p.props.interactive&&p.state.isVisible&&p.clearDelayTimeouts()}),w.addEventListener("mouseleave",function(){p.props.interactive&&p.props.trigger.indexOf("mouseenter")>=0&&K().addEventListener("mousemove",_)}),p;function S(){var m=p.props.touch;return Array.isArray(m)?m:[m,0]}function N(){return S()[0]==="hold"}function I(){var m;return!!((m=p.props.render)!=null&&m.$$tippy)}function T(){return b||t}function K(){var m=T().parentNode;return m?Cs(m):document}function te(){return ur(w)}function j(m){return p.state.isMounted&&!p.state.isVisible||xe.isTouch||f&&f.type==="focus"?0:ar(p.props.delay,m?0:1,ve.delay)}function V(m){m===void 0&&(m=!1),w.style.pointerEvents=p.props.interactive&&!m?"":"none",w.style.zIndex=""+p.props.zIndex}function M(m,C,E){if(E===void 0&&(E=!0),O.forEach(function(A){A[m]&&A[m].apply(A,C)}),E){var F;(F=p.props)[m].apply(F,C)}}function B(){var m=p.props.aria;if(m.content){var C="aria-"+m.content,E=w.id,F=bt(p.props.triggerTarget||t);F.forEach(function(A){var ne=A.getAttribute(C);if(p.state.isVisible)A.setAttribute(C,ne?ne+" "+E:E);else{var le=ne&&ne.replace(E,"").trim();le?A.setAttribute(C,le):A.removeAttribute(C)}})}}function ae(){if(!(D||!p.props.aria.expanded)){var m=bt(p.props.triggerTarget||t);m.forEach(function(C){p.props.interactive?C.setAttribute("aria-expanded",p.state.isVisible&&C===T()?"true":"false"):C.removeAttribute("aria-expanded")})}}function Ve(){K().removeEventListener("mousemove",_),yn=yn.filter(function(m){return m!==_})}function we(m){if(!(xe.isTouch&&(a||m.type==="mousedown"))){var C=m.composedPath&&m.composedPath()[0]||m.target;if(!(p.props.interactive&&yi(w,C))){if(bt(p.props.triggerTarget||t).some(function(E){return yi(E,C)})){if(xe.isTouch||p.state.isVisible&&p.props.trigger.indexOf("click")>=0)return}else M("onClickOutside",[p,m]);p.props.hideOnClick===!0&&(p.clearDelayTimeouts(),p.hide(),l=!0,setTimeout(function(){l=!1}),p.state.isMounted||Ce())}}}function Be(){a=!0}function ke(){a=!1}function de(){var m=K();m.addEventListener("mousedown",we,!0),m.addEventListener("touchend",we,Qe),m.addEventListener("touchstart",ke,Qe),m.addEventListener("touchmove",Be,Qe)}function Ce(){var m=K();m.removeEventListener("mousedown",we,!0),m.removeEventListener("touchend",we,Qe),m.removeEventListener("touchstart",ke,Qe),m.removeEventListener("touchmove",Be,Qe)}function at(m,C){lt(m,function(){!p.state.isVisible&&w.parentNode&&w.parentNode.contains(w)&&C()})}function Ee(m,C){lt(m,C)}function lt(m,C){var E=te().box;function F(A){A.target===E&&(pr(E,"remove",F),C())}if(m===0)return C();pr(E,"remove",u),pr(E,"add",F),u=F}function De(m,C,E){E===void 0&&(E=!1);var F=bt(p.props.triggerTarget||t);F.forEach(function(A){A.addEventListener(m,C,E),d.push({node:A,eventType:m,handler:C,options:E})})}function pt(){N()&&(De("touchstart",xt,{passive:!0}),De("touchend",zt,{passive:!0})),ys(p.props.trigger).forEach(function(m){if(m!=="manual")switch(De(m,xt),m){case"mouseenter":De("mouseleave",zt);break;case"focus":De(Is?"focusout":"blur",kt);break;case"focusin":De("focusout",kt);break}})}function $t(){d.forEach(function(m){var C=m.node,E=m.eventType,F=m.handler,A=m.options;C.removeEventListener(E,F,A)}),d=[]}function xt(m){var C,E=!1;if(!(!p.state.isEnabled||Ct(m)||l)){var F=((C=f)==null?void 0:C.type)==="focus";f=m,b=m.currentTarget,ae(),!p.state.isVisible&&xs(m)&&yn.forEach(function(A){return A(m)}),m.type==="click"&&(p.props.trigger.indexOf("mouseenter")<0||s)&&p.props.hideOnClick!==!1&&p.state.isVisible?E=!0:Et(m),m.type==="click"&&(s=!E),E&&!F&&Ue(m)}}function qt(m){var C=m.target,E=T().contains(C)||w.contains(C);if(!(m.type==="mousemove"&&E)){var F=Ne().concat(w).map(function(A){var ne,le=A._tippy,ct=(ne=le.popperInstance)==null?void 0:ne.state;return ct?{popperRect:A.getBoundingClientRect(),popperState:ct,props:n}:null}).filter(Boolean);Es(F,m)&&(Ve(),Ue(m))}}function zt(m){var C=Ct(m)||p.props.trigger.indexOf("click")>=0&&s;if(!C){if(p.props.interactive){p.hideWithInteractivity(m);return}Ue(m)}}function kt(m){p.props.trigger.indexOf("focusin")<0&&m.target!==T()||p.props.interactive&&m.relatedTarget&&w.contains(m.relatedTarget)||Ue(m)}function Ct(m){return xe.isTouch?N()!==m.type.indexOf("touch")>=0:!1}function Gt(){Kt();var m=p.props,C=m.popperOptions,E=m.placement,F=m.offset,A=m.getReferenceClientRect,ne=m.moveTransition,le=I()?ur(w).arrow:null,ct=A?{getBoundingClientRect:A,contextElement:A.contextElement||T()}:t,kr={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Qt){var ut=Qt.state;if(I()){var wo=te(),Nn=wo.box;["placement","reference-hidden","escaped"].forEach(function(en){en==="placement"?Nn.setAttribute("data-placement",ut.placement):ut.attributes.popper["data-popper-"+en]?Nn.setAttribute("data-"+en,""):Nn.removeAttribute("data-"+en)}),ut.attributes.popper={}}}},je=[{name:"offset",options:{offset:F}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!ne}},kr];I()&&le&&je.push({name:"arrow",options:{element:le,padding:3}}),je.push.apply(je,(C==null?void 0:C.modifiers)||[]),p.popperInstance=sr(ct,w,Object.assign({},C,{placement:E,onFirstUpdate:y,modifiers:je}))}function Kt(){p.popperInstance&&(p.popperInstance.destroy(),p.popperInstance=null)}function Pe(){var m=p.props.appendTo,C,E=T();p.props.interactive&&m===Pi||m==="parent"?C=E.parentNode:C=Si(m,[E]),C.contains(w)||C.appendChild(w),p.state.isMounted=!0,Gt()}function Ne(){return bn(w.querySelectorAll("[data-tippy-root]"))}function Et(m){p.clearDelayTimeouts(),m&&M("onTrigger",[p,m]),de();var C=j(!0),E=S(),F=E[0],A=E[1];xe.isTouch&&F==="hold"&&A&&(C=A),C?r=setTimeout(function(){p.show()},C):p.show()}function Ue(m){if(p.clearDelayTimeouts(),M("onUntrigger",[p,m]),!p.state.isVisible){Ce();return}if(!(p.props.trigger.indexOf("mouseenter")>=0&&p.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(m.type)>=0&&s)){var C=j(!1);C?i=setTimeout(function(){p.state.isVisible&&p.hide()},C):o=requestAnimationFrame(function(){p.hide()})}}function Pt(){p.state.isEnabled=!0}function Yt(){p.hide(),p.state.isEnabled=!1}function Xt(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(o)}function Jt(m){if(!p.state.isDestroyed){M("onBeforeUpdate",[p,m]),$t();var C=p.props,E=bi(t,Object.assign({},C,hi(m),{ignoreAttributes:!0}));p.props=E,pt(),C.interactiveDebounce!==E.interactiveDebounce&&(Ve(),_=mi(qt,E.interactiveDebounce)),C.triggerTarget&&!E.triggerTarget?bt(C.triggerTarget).forEach(function(F){F.removeAttribute("aria-expanded")}):E.triggerTarget&&t.removeAttribute("aria-expanded"),ae(),V(),P&&P(C,E),p.popperInstance&&(Gt(),Ne().forEach(function(F){requestAnimationFrame(F._tippy.popperInstance.forceUpdate)})),M("onAfterUpdate",[p,m])}}function Zt(m){p.setProps({content:m})}function mo(){var m=p.state.isVisible,C=p.state.isDestroyed,E=!p.state.isEnabled,F=xe.isTouch&&!p.props.touch,A=ar(p.props.duration,0,ve.duration);if(!(m||C||E||F)&&!T().hasAttribute("disabled")&&(M("onShow",[p],!1),p.props.onShow(p)!==!1)){if(p.state.isVisible=!0,I()&&(w.style.visibility="visible"),V(),de(),p.state.isMounted||(w.style.transition="none"),I()){var ne=te(),le=ne.box,ct=ne.content;lr([le,ct],0)}y=function(){var je;if(!(!p.state.isVisible||c)){if(c=!0,w.offsetHeight,w.style.transition=p.props.moveTransition,I()&&p.props.animation){var Dn=te(),Qt=Dn.box,ut=Dn.content;lr([Qt,ut],A),vi([Qt,ut],"visible")}B(),ae(),gi(wn,p),(je=p.popperInstance)==null||je.forceUpdate(),M("onMount",[p]),p.props.animation&&I()&&Ee(A,function(){p.state.isShown=!0,M("onShown",[p])})}},Pe()}}function go(){var m=!p.state.isVisible,C=p.state.isDestroyed,E=!p.state.isEnabled,F=ar(p.props.duration,1,ve.duration);if(!(m||C||E)&&(M("onHide",[p],!1),p.props.onHide(p)!==!1)){if(p.state.isVisible=!1,p.state.isShown=!1,c=!1,s=!1,I()&&(w.style.visibility="hidden"),Ve(),Ce(),V(!0),I()){var A=te(),ne=A.box,le=A.content;p.props.animation&&(lr([ne,le],F),vi([ne,le],"hidden"))}B(),ae(),p.props.animation?I()&&at(F,p.unmount):p.unmount()}}function ho(m){K().addEventListener("mousemove",_),gi(yn,_),_(m)}function vo(){p.state.isVisible&&p.hide(),p.state.isMounted&&(Kt(),Ne().forEach(function(m){m._tippy.unmount()}),w.parentNode&&w.parentNode.removeChild(w),wn=wn.filter(function(m){return m!==p}),p.state.isMounted=!1,M("onHidden",[p]))}function yo(){p.state.isDestroyed||(p.clearDelayTimeouts(),p.unmount(),$t(),delete t._tippy,p.state.isDestroyed=!0,M("onDestroy",[p]))}}function Ht(t,e){e===void 0&&(e={});var n=ve.plugins.concat(e.plugins||[]);Ts();var r=Object.assign({},e,{plugins:n}),i=ks(t);if(0)var o,s;var l=i.reduce(function(a,c){var f=c&&Ws(c,r);return f&&a.push(f),a},[]);return _n(t)?l[0]:l}Ht.defaultProps=ve;Ht.setDefaultProps=Ns;Ht.currentInput=xe;var Oi=function(e){var n=e===void 0?{}:e,r=n.exclude,i=n.duration;wn.forEach(function(o){var s=!1;if(r&&(s=Ti(r)?o.reference===r:o.popper===r.popper),!s){var l=o.props.duration;o.setProps({duration:i}),o.hide(),o.state.isDestroyed||o.setProps({duration:l})}})},_u=Object.assign({},Mt,{effect:function(e){var n=e.state,r={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,r.popper),n.styles=r,n.elements.arrow&&Object.assign(n.elements.arrow.style,r.arrow)}});Ht.setDefaultProps({render:Mi});var xn=Ht;var Di=()=>L("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-more-horizontal",children:[L("title",{children:"More details icon"}),L("circle",{cx:"12",cy:"12",r:"1"}),L("circle",{cx:"19",cy:"12",r:"1"}),L("circle",{cx:"5",cy:"12",r:"1"})]});var Vt,q,dr,Ni,Cn=0,Ui=[],G=W,Ri=G.__b,Ai=G.__r,Fi=G.diffed,Wi=G.__c,Hi=G.unmount,Vi=G.__;function gr(t,e){G.__h&&G.__h(q,t,Cn||e),Cn=0;var n=q.__H||(q.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function ji(t){return Cn=1,Hs(Gi,t)}function Hs(t,e,n){var r=gr(Vt++,2);if(r.t=t,!r.__c&&(r.__=[n?n(e):Gi(void 0,e),function(l){var a=r.__N?r.__N[0]:r.__[0],c=r.t(a,l);a!==c&&(r.__N=[c,r.__[1]],r.__c.setState({}))}],r.__c=q,!q.u)){var i=function(l,a,c){if(!r.__c.__H)return!0;var f=r.__c.__H.__.filter(function(y){return!!y.__c});if(f.every(function(y){return!y.__N}))return!o||o.call(this,l,a,c);var u=!1;return f.forEach(function(y){if(y.__N){var d=y.__[0];y.__=y.__N,y.__N=void 0,d!==y.__[0]&&(u=!0)}}),!(!u&&r.__c.props===l)&&(!o||o.call(this,l,a,c))};q.u=!0;var o=q.shouldComponentUpdate,s=q.componentWillUpdate;q.componentWillUpdate=function(l,a,c){if(this.__e){var f=o;o=void 0,i(l,a,c),o=f}s&&s.call(this,l,a,c)},q.shouldComponentUpdate=i}return r.__N||r.__}function $i(t,e){var n=gr(Vt++,3);!G.__s&&zi(n.__H,e)&&(n.__=t,n.i=e,q.__H.__h.push(n))}function qi(t){return Cn=5,Vs(function(){return{current:t}},[])}function Vs(t,e){var n=gr(Vt++,7);return zi(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Bs(){for(var t;t=Ui.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(kn),t.__H.__h.forEach(mr),t.__H.__h=[]}catch(e){t.__H.__h=[],G.__e(e,t.__v)}}G.__b=function(t){q=null,Ri&&Ri(t)},G.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Vi&&Vi(t,e)},G.__r=function(t){Ai&&Ai(t),Vt=0;var e=(q=t.__c).__H;e&&(dr===q?(e.__h=[],q.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(e.__h.forEach(kn),e.__h.forEach(mr),e.__h=[],Vt=0)),dr=q},G.diffed=function(t){Fi&&Fi(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Ui.push(e)!==1&&Ni===G.requestAnimationFrame||((Ni=G.requestAnimationFrame)||Us)(Bs)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),dr=q=null},G.__c=function(t,e){e.some(function(n){try{n.__h.forEach(kn),n.__h=n.__h.filter(function(r){return!r.__||mr(r)})}catch(r){e.some(function(i){i.__h&&(i.__h=[])}),e=[],G.__e(r,n.__v)}}),Wi&&Wi(t,e)},G.unmount=function(t){Hi&&Hi(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{kn(r)}catch(i){e=i}}),n.__H=void 0,e&&G.__e(e,n.__v))};var Bi=typeof requestAnimationFrame=="function";function Us(t){var e,n=function(){clearTimeout(r),Bi&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,100);Bi&&(e=requestAnimationFrame(n))}function kn(t){var e=q,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),q=e}function mr(t){var e=q;t.__c=t.__(),q=e}function zi(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function Gi(t,e){return typeof e=="function"?e(t):e}var Ki={"name-asc":{label:"Name",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-down-a-z"><path d="m3 16 4 4 4-4"/><path d="M7 20V4"/><path d="M20 8h-5"/><path d="M15 10V6.5a2.5 2.5 0 0 1 5 0V10"/><path d="M15 14h5l-5 6h5"/></svg>'},"name-desc":{label:"Name",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-z-a"><path d="m3 8 4-4 4 4"/><path d="M7 4v16"/><path d="M15 4h5l-5 6h5"/><path d="M15 20v-3.5a2.5 2.5 0 0 1 5 0V20"/><path d="M20 18h-5"/></svg>'},"mtime-asc":{label:"Date",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-down-0-1"><path d="m3 16 4 4 4-4"/><path d="M7 20V4"/><rect x="15" y="4" width="4" height="6" ry="2"/><path d="M17 20v-6h-2"/><path d="M15 20h4"/></svg>'},"mtime-desc":{label:"Date",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-1-0"><path d="m3 8 4-4 4 4"/><path d="M7 4v16"/><path d="M17 10V4h-2"/><path d="M15 10h4"/><rect x="15" y="14" width="4" height="6" ry="2"/></svg>'}},Yi=({plugin:t,onChange:e})=>{let[n,r]=ji(!1),i=qi(null),o=()=>{r(!n)},s=async l=>{r(!1),t.settings.sortOptionDefault=l,await t.saveSettings(),e()};return $i(()=>{let l=a=>{i.current&&!i.current.contains(a.target)&&r(!1)};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[]),L("div",{className:"snw-sort-dropdown-wrapper",ref:i,children:[L("button",{type:"button",onClick:o,class:"snw-sort-dropdown-button",children:L("div",{dangerouslySetInnerHTML:{__html:Ki[t.settings.sortOptionDefault].icon}})}),n&&L("ul",{className:"snw-sort-dropdown-list",children:Object.entries(Ki).map(([l,{label:a,icon:c}])=>L("li",{id:l,onClick:async f=>{f.stopPropagation(),await s(l)},class:"snw-sort-dropdown-list-item",children:[L("span",{dangerouslySetInnerHTML:{__html:c}}),L("span",{className:"snw-sort-dropdown-list-item-label",children:a})]}))})]})};var Xi=(t,e,n,r,i,o,s,l,a)=>{let c=L("div",{className:`${s?"snw-ref-title-popover":"snw-ref-title-side-pane"} tree-item-self is-clickable`,children:[L("div",{className:"snw-ref-title-popover-label","snw-ref-title-type":t,"snw-ref-title-reallink":e,"snw-ref-title-key":n,"snw-data-file-name":r,"snw-data-line-number":o.toString(),children:e}),L(Yi,{plugin:l,onChange:a}),s&&L("span",{className:"snw-ref-title-popover-open-sidepane-icon","snw-ref-title-type":t,"snw-ref-title-reallink":e,"snw-ref-title-key":n,"snw-data-file-name":r,"snw-data-line-number":o.toString(),children:L("span",{className:"snw-ref-title-popover-icon",onClick:u=>{u.stopPropagation(),Oi({duration:0}),l.activateView(t,e,n,r,Number(o))},children:L(Di,{})})})]}),f=createDiv();return _e(c,f),f};var et;function Qi(t){et=t}var hr=async(t,e,n,r,i,o)=>{let s=await Ji(t,n,r),l=createDiv();l.append(Xi(t,e,n,r,s.refCount,i,o,et,async()=>{let c=l.querySelector(".snw-ref-area");if(c){for(c.style.visibility="hidden";c.firstChild;)c.removeChild(c.firstChild);c.style.visibility="visible";let f=await Ji(t,n,r);c.prepend(f.response),setTimeout(async()=>{await En(!1,c)},500)}}));let a=createDiv({cls:"snw-ref-area"});return a.append(s.response),l.append(a),l},js=(t,e)=>t.sort((n,r)=>{let i=n.sourceFile,o=r.sourceFile;switch(e){case"name-asc":return i==null?void 0:i.basename.localeCompare(o==null?void 0:o.basename);case"name-desc":return o==null?void 0:o.basename.localeCompare(i==null?void 0:i.basename);case"mtime-asc":return(i==null?void 0:i.stat.mtime)-(o==null?void 0:o.stat.mtime);case"mtime-desc":return(o==null?void 0:o.stat.mtime)-(i==null?void 0:i.stat.mtime);default:return 0}}),Ji=async(t,e,n)=>{var u,y,d,_;let r=0,i=null;if(t==="File"){let b=Se(),h=[];for(let g of b.values())for(let v of g)v!=null&&v.resolvedFile&&((u=v==null?void 0:v.resolvedFile)==null?void 0:u.path)===n&&h.push(v);r=h.length,i=h}else{let b=Se().get(e);b===void 0&&(b=Se().get(e));let h=await $s(b);r=h.length,i=h}let o=Array.from(new Set(i.map(b=>{var h;return(h=b.sourceFile)==null?void 0:h.path}))).map(b=>i.find(h=>{var g;return((g=h.sourceFile)==null?void 0:g.path)===b})),s=js(o,et.settings.sortOptionDefault),l=createDiv(),a=et.settings.maxFileCountToDisplay;r<a&&(a=r);let c=0,f=null;et.settings.displayCustomPropertyList.trim()!==""&&(f=et.settings.displayCustomPropertyList.split(",").map(b=>b.trim()));for(let b=0;b<s.length;b++){if(c>a)continue;let h=s[b],g=createDiv();g.addClass("snw-ref-item-container"),g.addClass("tree-item"),l.appendChild(g);let v=createDiv();v.addClass("snw-ref-item-file"),v.addClass("tree-item-self"),v.addClass("search-result-file-title"),v.addClass("is-clickable"),v.setAttribute("snw-data-line-number","-1"),v.setAttribute("snw-data-file-name",h.sourceFile.path.replace(`.${(y=h.sourceFile)==null?void 0:y.extension}`,"")),v.setAttribute("data-href",h.sourceFile.path),v.setAttribute("href",h.sourceFile.path);let k=createDiv();k.addClass("snw-ref-item-file-icon"),k.addClass("tree-item-icon"),k.addClass("collapse-icon"),(0,Zi.setIcon)(k,"file-box");let p=createDiv();if(p.addClass("snw-ref-item-file-label"),p.addClass("tree-item-inner"),p.innerText=h.sourceFile.basename,v.append(k),v.append(p),g.appendChild(v),f!=null){let w=h.sourceFile?et.app.metadataCache.getFileCache(h.sourceFile):null;f.forEach(P=>{var D;let O=(D=w==null?void 0:w.frontmatter)==null?void 0:D[P];if(O){let S=L("div",{class:"snw-custom-property-container",children:[L("span",{class:"snw-custom-property-name",children:P}),L("span",{class:"snw-custom-property-text",children:[": ",O]})]}),N=createDiv();_e(S,N),p.append(N)}})}let x=createDiv();x.addClass("snw-ref-item-collection-items"),x.addClass("search-result-file-matches"),g.appendChild(x);for(let w of i)((d=h.sourceFile)==null?void 0:d.path)===((_=w.sourceFile)==null?void 0:_.path)&&c<a&&(c+=1,x.appendChild(await Gr(w)))}return{response:l,refCount:r}},$s=async t=>t.sort((e,n)=>{var o;let r=0;e.reference.position!==void 0&&(r=Number(e.reference.position.start.line));let i=0;return n.reference.position!==void 0&&(i=Number(n.reference.position.start.line)),((o=e.sourceFile)==null?void 0:o.basename.localeCompare(n.sourceFile.basename))||Number(r)-Number(i)});var tt;function eo(t){tt=t,zr(tt)}var Pn=async t=>{let{refType:e,realLink:n,key:r,filePath:i,lineNu:o}=await qs(t),s=createDiv();s.addClass("snw-popover-container"),s.addClass("search-result-container"),s.appendChild(await hr(e,n,r,i,o,!0)),t.setContent(s),setTimeout(async()=>{await En(!1,s)},500),cn(s)},to=async(t,e,n,r,i)=>{let o=createDiv();return o.addClass("snw-sidepane-container"),o.addClass("search-result-container"),o.append(await hr(t,e,n,r,i,!1)),setTimeout(async()=>{await En(!1,o)},500),o},En=async(t,e)=>{e.querySelectorAll(".snw-ref-item-file, .snw-ref-item-info, .snw-ref-title-popover-label").forEach(r=>{r.getAttribute("snw-has-handler")||(r.setAttribute("snw-has-handler","true"),r.addEventListener("click",async i=>{var f,u;i.preventDefault();let o=i.target.closest(".snw-ref-item-file, .snw-ref-item-info, .snw-ref-title-popover-label"),s=Number(o.getAttribute("snw-data-line-number")),l=o.getAttribute("snw-data-file-name"),a=app.metadataCache.getFirstLinkpathDest(l,l);if(!a){new nt.Notice(`File not found: ${l}. It may be a broken link.`);return}tt.app.workspace.getLeaf(nt.Keymap.isModEvent(i)).openFile(a);let c=o.getAttribute("snw-ref-title-key");if(c){if(c.contains("#^")){let y=Object.entries((f=tt.app.metadataCache.getFileCache(a))==null?void 0:f.blocks);if(y){let d=c.match(/#\^(.+)$/g)[0].replace("#^","").toLowerCase();s=y.find(b=>b[0]===d)[1].position.start.line}}else if(c.contains("#")){let y=(u=tt.app.metadataCache.getFileCache(a))==null?void 0:u.headings;if(y){let d=c.match(/#(.+)/g)[0].replace("#","");s=y.find(b=>b.heading===d).position.start.line}}}s>0&&setTimeout(()=>{try{tt.app.workspace.getActiveViewOfType(nt.MarkdownView).setEphemeralState({line:s})}catch(y){}},400)}),tt.app.internalPlugins.plugins["page-preview"].enabled===!0&&r.addEventListener("mouseover",i=>{i.preventDefault();let o=app.internalPlugins.plugins["page-preview"].instance.overrides["obsidian42-strange-new-worlds"]!==!1;if(o===!1||o===!0&&nt.Keymap.isModifier(i,"Mod")){let s=i.target,l={scroll:Number(s.getAttribute("snw-data-line-number"))},a=s.getAttribute("snw-data-file-name");a&&app.workspace.trigger("link-hover",{},s,a,"",l)}}))})},qs=async t=>{let e=t.reference,n=e.getAttribute("data-snw-type"),r=e.getAttribute("data-snw-reallink"),i=e.getAttribute("data-snw-key"),o=e.getAttribute("data-snw-filepath"),s=Number(e.getAttribute("snw-data-line-number"));return{refType:n,realLink:r,key:i,filePath:o,lineNu:s}};var Me="Strange New Worlds",Sn=class extends no.ItemView{constructor(e,n){super(e),this.plugin=n}getViewType(){return Me}getDisplayText(){return Me}getIcon(){return"file-digit"}async onOpen(){_e(L("div",{class:"snw-sidepane-loading",children:[L("div",{class:"snw-sidepane-loading-banner",children:"Discovering Strange New Worlds..."}),L("div",{class:"snw-sidepane-loading-subtext",children:"Click a reference counter in the main document for information to appear here."})]}),this.containerEl.querySelector(".view-content"))}async updateView(){let e=this.plugin.lastSelectedReferenceType,n=this.plugin.lastSelectedReferenceRealLink,r=this.plugin.lastSelectedReferenceKey,i=this.plugin.lastSelectedReferenceFilePath,o=this.plugin.lastSelectedLineNumber;this.containerEl.replaceChildren(await to(e,n,r,i,o)),cn(this.containerEl)}async onClose(){console.log("Closing SNW sidepane")}};var ot=require("obsidian");var Bt=require("obsidian");var _t;function ro(t){_t=t}function ye(t,e,n,r,i,o,s){let l=L("div",{className:`snw-reference snw-${e} ${o}`,"data-snw-type":e,"data-snw-reallink":n,"data-snw-key":r,"data-snw-filepath":i,"snw-data-line-number":s.toString(),children:t.toString()}),a=createDiv();_e(l,a);let c=a.firstElementChild;(Bt.Platform.isDesktop||Bt.Platform.isDesktopApp)&&(c.onclick=async d=>Tn(d.target));let f=_t.settings.requireModifierKeyToActivateSNWView,u=!0;return xn(c,{interactive:!0,appendTo:()=>document.body,allowHTML:!0,zIndex:9999,placement:"auto-end",onTrigger(d,_){let b=_;f!==!1&&(b.ctrlKey||b.metaKey?u=!0:u=!1)},onShow(d){if(!u)return!1;setTimeout(async()=>{await Pn(d)},1)}}).popper.classList.add("snw-tippy"),a}var Tn=async t=>{var s,l,a,c,f;let e=(s=t.getAttribute("data-snw-type"))!=null?s:"",n=(l=t.getAttribute("data-snw-realLink"))!=null?l:"",r=(a=t.getAttribute("data-snw-key"))!=null?a:"",i=(c=t.getAttribute("data-snw-filepath"))!=null?c:"",o=(f=t.getAttribute("snw-data-line-number"))!=null?f:"";_t.activateView(e,n,r,i,Number(o))},vr=(0,Bt.debounce)(()=>{document.querySelectorAll(".snw-liveupdate").forEach(t=>{let e=Number(t.innerText),n=t.getAttribute("data-snw-key");if(_t.snwAPI.references.has(n)){let r=_t.snwAPI.references.get(n).length;r===0||r<_t.settings.minimumRefCountThreshold?t.remove():r!==e&&(t.innerText=r.toString())}else t.remove()})},rt,!0);var it;function oo(t){it=t}function zs(){it.app.workspace.iterateAllLeaves(t=>{t.view instanceof ot.MarkdownView&&Gs(t.view)})}var Ln=(0,ot.debounce)(()=>{zs()},rt,!0);function Gs(t){var r;if(it.showCountsActive===!1||(ot.Platform.isMobile||ot.Platform.isMobileApp?it.settings.displayPropertyReferencesMobile:it.settings.displayPropertyReferences)===!1||(t==null?void 0:t.rawFrontmatter)==="")return;let n=pe(t.file);((r=n.frontmatterLinks)==null?void 0:r.length)!==0&&t.metadataEditor.rendered.forEach(i=>{var s;let o=i.valueEl.querySelector(".metadata-link-inner.internal-link");if(o){let l=(s=n.frontmatterLinks)==null?void 0:s.find(a=>a.displayText===o.innerText);l&&io(o,l)}else{let l=i.valueEl.querySelectorAll(".multi-select-pill.internal-link .multi-select-pill-content span");l.length>0&&l.forEach(a=>{var c;if(a){let f=(c=n.frontmatterLinks)==null?void 0:c.find(u=>u.displayText===a.innerText);f&&io(a.parentElement,f)}})}})}function io(t,e){var i,o,s,l,a;let n=(i=t.parentElement)==null?void 0:i.querySelector(".snw-frontmatter-wrapper"),r=e.references.length;if(!n&&r>=it.settings.minimumRefCountThreshold){n=createSpan({cls:"snw-frontmatter-wrapper"});let c=ye(r,"link",e.references[0].realLink,e.key,(a=(o=e.references[0])==null?void 0:o.resolvedFile)==null?void 0:a.path.replace(`.${(l=(s=e.references[0])==null?void 0:s.resolvedFile)==null?void 0:l.extension}`,""),"snw-frontmatter-count",e.pos.start.line);n.appendChild(c),t.insertAdjacentElement("afterend",n)}else try{if(r>=it.settings.minimumRefCountThreshold){let c=n==null?void 0:n.querySelector(".snw-frontmatter-count");c&&(c.innerText=` ${r} `)}else n==null||n.remove()}catch(c){}}var Ut=require("obsidian");var yr;function so(t){yr=t}function Ks(){yr.app.workspace.iterateAllLeaves(t=>{t.view.getViewType()==="markdown"&&Ys(t.view)})}var In=(0,Ut.debounce)(()=>{Ks()},rt,!0);function Ys(t){var y,d,_,b,h;let e=t.file;if(!e)return;let n=Se(),r=[];for(let g of n.values())for(let v of g)v!=null&&v.resolvedFile&&((y=v==null?void 0:v.resolvedFile)==null?void 0:y.path)===e.path&&r.push(v);let i=r.length,o=pe(e);if(((_=(d=o==null?void 0:o.cacheMetaData)==null?void 0:d.frontmatter)==null?void 0:_["snw-file-exclude"])===!0&&(i=0),i<1){t.contentEl.querySelector(".snw-header-count-wrapper")&&((b=t.contentEl.querySelector(".snw-header-count-wrapper"))==null||b.remove());return}let s=t.contentEl.querySelector(".snw-header-count");if(s&&s.getAttribute("data-snw-key")===e.basename){s.innerText=` ${r.length.toString()} `;return}let l=t.contentEl;t.contentEl.querySelector(".snw-header-count-wrapper")&&((h=t.contentEl.querySelector(".snw-header-count-wrapper"))==null||h.remove());let a=l.querySelector(".snw-header-count-wrapper");a?s=l.querySelector(".snw-header-count"):(a=createDiv({cls:"snw-reference snw-header-count-wrapper"}),s=createDiv({cls:"snw-header-count"}),a.appendChild(s),l.prepend(a)),s&&(s.innerText=` ${r.length.toString()} `),(Ut.Platform.isDesktop||Ut.Platform.isDesktopApp)&&s&&(s.onclick=g=>{g.stopPropagation(),a&&Tn(a)}),a.setAttribute("data-snw-reallink",e.basename),a.setAttribute("data-snw-key",e.basename),a.setAttribute("data-snw-type","File"),a.setAttribute("data-snw-filepath",e.path),a.onclick=g=>{g.stopPropagation(),Tn(g.target)};let c=yr.settings.requireModifierKeyToActivateSNWView,f=!0;xn(a,{interactive:!0,appendTo:()=>document.body,allowHTML:!0,zIndex:9999,placement:"auto-end",onTrigger(g,v){let k=v;c!==!1&&(k.ctrlKey||k.metaKey?f=!0:f=!1)},onShow(g){if(!f)return!1;setTimeout(async()=>{await Pn(g)},1)}}).popper.classList.add("snw-tippy")}var jt=require("@codemirror/view"),Mn=require("obsidian");var wr;function ao(t){wr=t}var Xs=class extends jt.GutterMarker{constructor(t,e,n,r,i,o){super(),this.referenceCount=t,this.referenceType=e,this.realLink=n,this.key=r,this.filePath=i,this.addCssClass=o}toDOM(){return ye(this.referenceCount,this.referenceType,this.realLink,this.key,this.filePath,this.addCssClass,0)}},Js=new class extends jt.GutterMarker{toDOM(){return document.createTextNode("\xF8\xF8\xF8")}},Zs=(0,jt.gutter)({class:"snw-gutter-ref",lineMarker(t,e){var o,s,l,a,c,f,u,y,d,_;let n=t.state.field(Mn.editorInfoField);if(((o=n.currentMode)==null?void 0:o.sourceMode)===!0&&wr.settings.displayInlineReferencesInSourceMode===!1||!n.file)return null;let r=pe(n.file);if(((l=(s=r==null?void 0:r.cacheMetaData)==null?void 0:s.frontmatter)==null?void 0:l["snw-file-exclude"])===!0||((c=(a=r==null?void 0:r.cacheMetaData)==null?void 0:a.frontmatter)==null?void 0:c["snw-canvas-exclude-edit"])===!0)return null;let i=(f=n.app.metadataCache.getFileCache(n.file))==null?void 0:f.embeds;if(!i)return null;if((i==null?void 0:i.length)>=0){let b=t.state.doc.lineAt(e.from).number;for(let h of i)if(h.position.start.line+1===b){for(let g of(u=r==null?void 0:r.embeds)!=null?u:[])if((g==null?void 0:g.references.length)>=wr.settings.minimumRefCountThreshold&&(g==null?void 0:g.pos.start.line)+1===b){let v=t.state.doc.lineAt(e.from).text.trim();if(v.startsWith("!")){let k=v.replace("![[","").replace("]]",""),p="";if(k.startsWith("#")?p=n.file.path.replace(`.${n.file.path}`,"")+(0,Mn.stripHeading)(k):(p=be(k),p===""&&(p=k)),p===g.key)return new Xs(g.references.length,"embed",g.references[0].realLink,g.key,((d=(y=g.references[0].resolvedFile)==null?void 0:y.path)!=null?d:"").replace(`.${(_=g.references[0].resolvedFile)==null?void 0:_.extension}`,""),"snw-embed-special snw-liveupdate")}}}}return null},initialSpacer:()=>Js}),lo=Zs;var Oe=require("@codemirror/view"),st=require("obsidian");var We;function po(t){We=t}var co=Oe.ViewPlugin.fromClass(class{constructor(t){this.view=t;this.decorations=Oe.Decoration.none;this.regxPattern="";We.settings.enableRenderingBlockIdInLivePreview&&(this.regxPattern="(\\s\\^)(\\S+)$"),We.settings.enableRenderingEmbedsInLivePreview&&(this.regxPattern+=`${this.regxPattern!==""?"|":""}!\\[\\[(.*?)\\]\\]`),We.settings.enableRenderingLinksInLivePreview&&(this.regxPattern+=`${this.regxPattern!==""?"|":""}\\[\\[(.*?)\\]\\]`),We.settings.enableRenderingHeadersInLivePreview&&(this.regxPattern+=`${this.regxPattern!==""?"|":""}^#+\\s.+`),this.regxPattern!==""&&(this.decorator=new Oe.MatchDecorator({regexp:new RegExp(this.regxPattern,"g"),decorate:(e,n,r,i,o)=>{var c,f,u,y,d,_,b,h,g,v,k,p,x,w,P,O,D,S,N,I,T,K,te;let s=o.state.field(st.editorInfoField);if(!s.file)return;if(((c=s.currentMode)==null?void 0:c.sourceMode)===!0&&We.settings.displayInlineReferencesInSourceMode===!1)return null;let l=s.file,a=pe(l);if(((u=(f=a==null?void 0:a.cacheMetaData)==null?void 0:f.frontmatter)==null?void 0:u["snw-file-exclude"])!==!0&&((d=(y=a==null?void 0:a.cacheMetaData)==null?void 0:y.frontmatter)==null?void 0:d["snw-canvas-exclude-edit"])!==!0){let j=i[0].charAt(0),V=[];if(j===" "&&((b=(_=a==null?void 0:a.blocks)==null?void 0:_.length)!=null?b:0)>0)V.push({key:l.path.replace(`.${(h=s.file)==null?void 0:h.extension}`,"")+i[0].replace(" ^","#^"),transformedCachedItem:(g=a.blocks)!=null?g:null,refType:"block",from:r,to:r});else if(j==="!"&&((k=(v=a==null?void 0:a.embeds)==null?void 0:v.length)!=null?k:0)>0){let M=i[0].replace("![[","").replace("]]","");M.startsWith("#")&&(M=l.path.replace(`.${(p=s.file)==null?void 0:p.extension}`,"")+(0,st.stripHeading)(M)),V.push({key:M,transformedCachedItem:(x=a.embeds)!=null?x:null,refType:"embed",from:r,to:r})}else if(j==="["&&((P=(w=a==null?void 0:a.links)==null?void 0:w.length)!=null?P:0)>0){let M=i[0].replace("[[","").replace("]]","");M.startsWith("#")&&(M=l.path.replace(`.${(O=s.file)==null?void 0:O.extension}`,"")+M),V.push({key:M,transformedCachedItem:(D=a.links)!=null?D:null,refType:"link",from:r,to:r})}else if(j==="#"&&((N=(S=a==null?void 0:a.headings)==null?void 0:S.length)!=null?N:0)>0&&(V.push({key:(0,st.stripHeading)(i[0].replace(/^#+/,"").substring(1)),transformedCachedItem:(I=a.headings)!=null?I:null,refType:"heading",from:r,to:r}),We.settings.enableRenderingLinksInLivePreview)){let M=i[0].match(/\[\[(.*?)\]\]|!\[\[(.*?)\]\]/g);if(M)for(let B of M)V.push({key:B.replace("![[","").replace("[[","").replace("]]",""),transformedCachedItem:B.startsWith("!")?(T=a.embeds)!=null?T:null:(K=a.links)!=null?K:null,refType:"link",from:r-i[0].length+(i[0].indexOf(B)+B.length),to:r-i[0].length+(i[0].indexOf(B)+B.length)})}for(let M of V.sort((B,ae)=>B.to-ae.to))if(M.key!==""){let B=Qs(M.refType,M.key,(te=M.transformedCachedItem)!=null?te:[],l.path,l.extension);B!=null&&e(M.from,M.to,Oe.Decoration.widget({widget:B,side:1}))}}}}),this.decorations=this.decorator.createDeco(t))}update(t){var e;this.regxPattern!==""&&(t.docChanged||t.viewportChanged)&&(this.decorations=(e=this.decorator)==null?void 0:e.updateDeco(t,this.decorations))}},{decorations:t=>t.decorations}),Qs=(t,e,n,r,i)=>{var s,l;let o=e;for(let a=0;a<n.length;a++){let c=n[a],f=c.key;if(t==="heading"&&(f=(0,st.stripHeading)((s=c.headerMatch)!=null?s:""),o=o.replace(/^\s+|\s+$/g,"")),t==="embed"||t==="link"){o.contains("|")&&(o=o.substring(0,e.search(/\|/)));let u=be(e);o=u===""?o:u,f.startsWith("#")&&(f=r.replace(`.${i}`,"")+(0,st.stripHeading)(f))}if(f===o){let u=(l=c==null?void 0:c.references[0])!=null&&l.resolvedFile?c.references[0].resolvedFile.path.replace(`.${c.references[0].resolvedFile}`,""):o;return(c==null?void 0:c.references.length)>=We.settings.minimumRefCountThreshold?new br(c.references.length,c.type,c.references[0].realLink,c.key,u,"snw-liveupdate",c.pos.start.line):null}}return null},br=class extends Oe.WidgetType{constructor(e,n,r,i,o,s,l){super(),this.referenceCount=e,this.referenceType=n,this.realLink=r,this.key=i,this.filePath=o,this.addCssClass=s,this.lineNu=l}toDOM(){return ye(this.referenceCount,this.referenceType,this.realLink,this.key,this.filePath,this.addCssClass,this.lineNu)}destroy(){}ignoreEvent(){return!1}};var uo=require("obsidian");var He;function fo(t){He=t}function xr(t,e){var i,o;if(e.remainingNestLevel===4||t.hasAttribute("uic")||t.querySelectorAll(".contains-task-list").length>0)return;let n=He.app.vault.fileMap[e.sourcePath];if(n===void 0)return;let r=He.app.metadataCache.getFileCache(n);if(!((i=r==null?void 0:r.frontmatter)!=null&&i["kanban-plugin"]||(o=e.el.parentElement)!=null&&o.classList.contains("kanban-plugin__markdown-preview-view")))try{e.addChild(new _r(t,e.getSectionInfo(t),n))}catch(s){}}var _r=class extends uo.MarkdownRenderChild{constructor(e,n,r){super(e),this.containerEl=e,this.sectionInfo=n,this.currentFile=r}onload(){this.processMarkdown()}processMarkdown(){var r,i,o,s,l,a,c,f,u,y,d,_,b,h,g,v;let e=He.settings.minimumRefCountThreshold,n=pe(this.currentFile);if(((i=(r=n==null?void 0:n.cacheMetaData)==null?void 0:r.frontmatter)==null?void 0:i["snw-file-exclude"])!==!0&&((s=(o=n==null?void 0:n.cacheMetaData)==null?void 0:o.frontmatter)==null?void 0:s["snw-canvas-exclude-preview"])!==!0&&(n!=null&&n.blocks||n.embeds||n.headings||n.links)){if(He.settings.enableRenderingBlockIdInMarkdown&&(n!=null&&n.blocks)){for(let k of n.blocks)if(k.references.length>=e&&k.pos.start.line>=((l=this.sectionInfo)==null?void 0:l.lineStart)&&k.pos.end.line<=((a=this.sectionInfo)==null?void 0:a.lineEnd)){let p=ye(k.references.length,"block",k.references[0].realLink,k.key,(y=(c=k.references[0])==null?void 0:c.resolvedFile)==null?void 0:y.path.replace(`.${(u=(f=k.references[0])==null?void 0:f.resolvedFile)==null?void 0:u.path}`,""),"snw-liveupdate",k.pos.start.line),x=this.containerEl.querySelector("p"),w=k.pos.start.line-this.sectionInfo.lineStart;x?(x||(x=this.containerEl.querySelector(`ol[data-line="${w}"]`)),x.append(p)):(x=this.containerEl.querySelector(`li[data-line="${w}"]`),x.querySelector("ul")?x.querySelector("ul").before(p):x.append(p));try{x.hasClass("snw-block-preview")||p.addClass("snw-block-preview")}catch(P){}}}if(He.settings.enableRenderingEmbedsInMarkdown&&(n!=null&&n.embeds)&&this.containerEl.querySelectorAll(".internal-embed:not(.snw-embed-preview)").forEach(k=>{var x,w,P,O,D,S,N;let p=be(`${k.getAttribute("src")}`);p=p===""?`${k.getAttribute("src")}`:p;for(let I of(x=n.embeds)!=null?x:[])if(I.references.length>=e&&p===I.key){let T=ye(I.references.length,"embed",I.references[0].realLink,I.key,((O=(P=(w=I.references[0])==null?void 0:w.resolvedFile)==null?void 0:P.path)!=null?O:"").replace(`.${(N=(S=(D=I.references[0])==null?void 0:D.resolvedFile)==null?void 0:S.extension)!=null?N:""}`,""),"snw-liveupdate",I.pos.start.line);T.addClass("snw-embed-preview"),k.after(T);break}}),He.settings.enableRenderingHeadersInMarkdown){let k=this.containerEl.querySelector("[data-heading]");if(n!=null&&n.headings&&k){let p=k.getAttribute("data-heading");for(let x of n.headings)if(x.references.length>=e&&x.headerMatch===(p==null?void 0:p.replace(/\[|\]/g,""))){let w=ye(x.references.length,"heading",x.references[0].realLink,x.key,((b=(_=(d=x.references[0])==null?void 0:d.resolvedFile)==null?void 0:_.path)!=null?b:"").replace(`.${(v=(g=(h=x.references[0])==null?void 0:h.resolvedFile)==null?void 0:g.extension)!=null?v:""}`,""),"",x.pos.start.line);w.addClass("snw-heading-preview");let P=this.containerEl.querySelector("h1,h2,h3,h4,h5,h6");P&&P.insertAdjacentElement("beforeend",w);break}}}He.settings.enableRenderingLinksInMarkdown&&(n!=null&&n.links)&&this.containerEl.querySelectorAll("a.internal-link").forEach(k=>{var x,w,P,O,D,S,N,I;let p=be(`${k.getAttribute("data-href")}`);p=p===""?`${k.getAttribute("data-href")}`:p;for(let T of(x=n.links)!=null?x:[])if(T.references.length>=e&&(T.key===p||(w=T==null?void 0:T.original)!=null&&w.contains(p))){let K=ye(T.references.length,"link",T.references[0].realLink,T.key,((D=(O=(P=T.references[0])==null?void 0:P.resolvedFile)==null?void 0:O.path)!=null?D:"").replace(`.${(I=(N=(S=T.references[0])==null?void 0:S.resolvedFile)==null?void 0:N.extension)!=null?I:""}`,""),"snw-liveupdate",T.pos.start.line);K.addClass("snw-link-preview"),k.after(K);break}})}}};var rt=200,On=class extends se.Plugin{constructor(){super(...arguments);this.appName=this.manifest.name;this.appID=this.manifest.id;this.APP_ABBREVIARTION="SNW";this.settings=nn;this.showCountsActive=nn.enableOnStartupDesktop;this.lastSelectedReferenceType="";this.lastSelectedReferenceRealLink="";this.lastSelectedReferenceKey="";this.lastSelectedReferenceFilePath="";this.lastSelectedLineNumber=0;this.snwAPI=new St(this);this.markdownPostProcessor=null;this.editorExtensions=[];this.commands=new Tt(this)}async onload(){console.log(`loading ${this.appName}`),Er(this),Qi(this),ro(this),ao(this),so(this),oo(this),fo(this),po(this),eo(this),window.snwAPI=this.snwAPI,await this.loadSettings(),this.addSettingTab(new rn(this.app,this)),se.Platform.isMobile||se.Platform.isMobileApp?this.showCountsActive=this.settings.enableOnStartupMobile:this.showCountsActive=this.settings.enableOnStartupDesktop,this.registerView(Me,i=>new Sn(i,this));let n=(0,se.debounce)(()=>{tn(),In(),Ln(),vr()},3e3,!0),r=(0,se.debounce)(async(i,o,s)=>{await Pr(i),Wn(i,s),In(),Ln(),vr()},500,!0);this.registerEvent(this.app.vault.on("rename",n)),this.registerEvent(this.app.vault.on("delete",n)),this.registerEvent(this.app.metadataCache.on("changed",r)),this.app.workspace.registerHoverLinkSource(this.appID,{display:this.appName,defaultMod:!0}),this.snwAPI.settings=this.settings,this.registerEditorExtension(this.editorExtensions),this.toggleStateHeaderCount(),this.toggleStateSNWMarkdownPreview(),this.toggleStateSNWLivePreview(),this.toggleStateSNWGutters(),this.app.workspace.onLayoutReady(async()=>{var i,o;(i=this.app.workspace.getLeavesOfType(Me))!=null&&i.length||await((o=this.app.workspace.getRightLeaf(!1))==null?void 0:o.setViewState({type:Me,active:!1})),tn()})}async layoutChangeEvent(){In(),Ln()}async activateView(n,r,i,o,s){this.lastSelectedReferenceType=n,this.lastSelectedReferenceRealLink=r,this.lastSelectedReferenceKey=i,this.lastSelectedReferenceFilePath=o,this.lastSelectedLineNumber=s;let{workspace:l}=this.app,a=null,c=l.getLeavesOfType(Me);if(c.length>0)a=c[0];else{let f=l.getRightLeaf(!1);await(f==null?void 0:f.setViewState({type:Me,active:!0}))}a&&l.revealLeaf(a),await this.app.workspace.getLeavesOfType(Me)[0].view.updateView()}toggleStateHeaderCount(){this.settings.displayIncomingFilesheader&&this.showCountsActive?this.app.workspace.on("layout-change",this.layoutChangeEvent):this.app.workspace.off("layout-change",this.layoutChangeEvent)}toggleStateSNWMarkdownPreview(){this.settings.displayInlineReferencesMarkdown&&this.showCountsActive&&this.markdownPostProcessor===null?this.markdownPostProcessor=this.registerMarkdownPostProcessor((n,r)=>xr(n,r),100):(this.markdownPostProcessor?se.MarkdownPreviewRenderer.unregisterPostProcessor(this.markdownPostProcessor):console.log("Markdown post processor is not registered"),this.markdownPostProcessor=null)}toggleStateSNWLivePreview(){let n=this.settings.displayInlineReferencesLivePreview;n===!0&&(n=this.showCountsActive),this.updateCMExtensionState("inline-ref",n,co)}toggleStateSNWGutters(){let n=se.Platform.isMobile||se.Platform.isMobileApp?this.settings.displayEmbedReferencesInGutterMobile:this.settings.displayEmbedReferencesInGutter;n===!0&&(n=this.showCountsActive),this.updateCMExtensionState("gutter",n,lo)}updateCMExtensionState(n,r,i){if(r===!0)this.editorExtensions.push(i),this.editorExtensions[this.editorExtensions.length-1].snwID=n;else for(let o=0;o<this.editorExtensions.length;o++)if(this.editorExtensions[o].snwID===n){this.editorExtensions.splice(o,1);break}this.app.workspace.updateOptions()}async loadSettings(){this.settings=Object.assign({},nn,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}onunload(){console.log(`unloading ${this.appName}`);try{this.markdownPostProcessor?se.MarkdownPreviewRenderer.unregisterPostProcessor(this.markdownPostProcessor):console.log("Markdown post processor is not registered"),this.app.workspace.unregisterHoverLinkSource(this.appID)}catch(n){}}};

/* nosourcemap */